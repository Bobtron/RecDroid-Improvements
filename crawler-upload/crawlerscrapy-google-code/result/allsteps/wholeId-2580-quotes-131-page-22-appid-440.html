https://code.google.com/archive/p/csipsimple/issues/2204<!DOCTYPE html><html class="google ng-scope" lang="en" ng-app="codesiteArchive.application"><head>
    <meta charset="utf-8">
    <meta content="initial-scale=1, minimum-scale=1, width=device-width" name="viewport">

    <!-- https://developers.google.com/webmasters/ajax-crawling/docs/specification -->
    <meta name="fragment" content="!">
    <title>Google Code Archive - Long-term storage for Google Code Project Hosting.</title>

    <link rel="icon" type="image/vnd.microsoft.icon" href="/archive/img/project-hosting.ico">
    <script src="//www.google.com/js/google.js"></script>
    <link href="//www.google.com/css/maia.css" rel="stylesheet">
    <link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,600,700&amp;lang=en" rel="stylesheet">
    <link rel="stylesheet" href="/archive/archive_css.css">
    <script>
      CLOSURE_NO_DEPS = true;
    </script>
    <script src="/archive/angular.js"></script><style type="text/css">@charset "UTF-8";

[ng\:cloak], [ng-cloak], [data-ng-cloak], [x-ng-cloak],
.ng-cloak, .x-ng-cloak,
.ng-hide:not(.ng-hide-animate) {
  display: none !important;
}

ng\:form {
  display: block;
}

.ng-animate-shim {
  visibility:hidden;
}

.ng-anchor {
  position:absolute;
}
</style>
    <script src="/archive/pagedown.js"></script>
    <script src="/archive/archive.js"></script>
    <base href="/archive/">
  </head>

  <body>
    <div class="maia-header" id="maia-header" role="banner">
      <div class="maia-aux">
        <a href="/archive/">
          </a><h1><a href="/archive/">
            <img alt="Google" src="//www.google.com/images/branding/googlelogo/1x/googlelogo_color_116x41dp.png"> Code</a>
          </h1>
        
        <a href="/archive/">
          <h2>Archive</h2>
        </a>
        <a class="maia-teleport" href="#content">Skip to content</a>
        <div class="maia-util">
          <form action="/archive/search" class="maia-search ng-pristine ng-valid">
            <input name="q" placeholder="Search this site" type="text">
            <button class="maia-button">
              <span class="maia-search-icon">Search</span>
            </button>
          </form>
        </div>
      </div>
    </div>

    <!-- ngView: --><div ng-view="" class="ng-scope"><div ng-controller="ProjectIssueCtrl as issueCtrl" class="ng-scope">
<nav-bar-widget nav-level-1="projectCtrl.navLevel1" class="ng-isolate-scope"><div class="maia-nav maia-complex" id="maia-nav-x" role="navigation">
  <div class="maia-aux">
    <ul>
      <li ng-class="{active: navLevel1 == 'projects'}">
        <a href="/archive/">Projects</a>
        <!-- ngIf: navLevel2 -->
      </li>
      <li ng-class="{active: navLevel1 == 'search'}">
        <a href="/archive/search">Search</a>
      </li>
      <li ng-class="{active: navLevel1 == 'about'}">
        <a href="/archive/about">About</a>
      </li>
    </ul>
  </div>
</div>
</nav-bar-widget>
<div id="maia-main" role="main">

  <!-- ngIf: issueCtrl.notFound -->

  <div ng-hide="issueCtrl.notFound">
    <!-- Left-side resource nav -->
    <project-resources-widget domain="issueCtrl.domain" project="issueCtrl.projectName" class="ng-isolate-scope"><div class="maia-nav" id="maia-nav-y" role="navigation">
  <!-- ngIf: domain == 'code.google.com' --><ul ng-if="domain == 'code.google.com'" class="ng-scope">
    <li class="active">
      <a href="/archive/p/csipsimple/">Project</a>
    </li>
    <li>
      <a href="/archive/p/csipsimple/source">Source</a>
    </li>
    <li>
      <a href="/archive/p/csipsimple/issues">Issues</a>
    </li>
    <li>
      <a href="/archive/p/csipsimple/wikis">Wikis</a>
    </li>
    <li>
      <a href="/archive/p/csipsimple/downloads">Downloads</a>
    </li>
  </ul><!-- end ngIf: domain == 'code.google.com' -->

    <!-- ngIf: domain != 'code.google.com' -->
</div></project-resources-widget>

    <div class="maia-article" role="article">
      <div class="maia-teleport" id="content"></div>
      <div class="maia-cols">
        <div id="gca-project-header" class="maia-col-10">
          <a id="gca-export-to-gh" class="maia-button" href="https://code.google.com/export-to-github/export?project=csipsimple">Export to GitHub</a>
            <img class="gca-project-logo" src="https://storage.googleapis.com/google-code-archive/v2/code.google.com/csipsimple/logo.png">
            <h1 class="ng-binding">csipsimple - issue #2204</h1>
            <p class="ng-binding">com.css.ui.dialer.DialerLayout not initialized properly on tablets</p>
        </div>

        <div class="maia-col-10">
          <hr>

        <!-- ngIf: issueCtrl.error -->

        <!-- ngIf: !issueCtrl.error --><div ng-if="!issueCtrl.error" class="ng-scope">
          <!-- Comments -->
          <div class="maia-col-8">
            <!-- ngRepeat: comment in issueCtrl.issue.comments --><div ng-repeat="comment in issueCtrl.issue.comments" class="ng-scope">
              <div>
                <!-- ngIf: comment.id -->
                <!-- ms to seconds. -->
                <small class="ng-binding">
                  Posted on Jan 28, 2013 by
                  <i class="ng-binding">Helpful Cat</i>
                </small>
              </div>

              <!-- TODO(chrsmith): Get the formatting right. Google Code comments
              are not stored in wiki/markdown or HTML format. So we probably need to
              create a custom filter to get 100% paritiy. -->
              <!-- ngIf: comment.content --><span ng-if="comment.content" class="ng-scope">
                <markdown-widget text="comment.content" class="markdown"><p><b>What steps will reproduce the problem?</b>
1. Install CSS r2096 on a tablet or other large screen device where the contact list should appear on the dialer tab
2. Launch the application</p>

<p><b>What is the expected output? What do you see instead?</b></p>

<p>The DialerLayout is visible but is empty. If you press the ActionBar "txt" button it is then populated with contacts. Pressing the ActionBar '123' button also shows the contacts list populated.</p>

<p><b>What version of the product are you using? On what operating system?</b></p>

<p>Samsung Galaxy Tab
CyanogenMod 10
CSS r2096</p>

<p><b>Please provide any additional information below.</b></p>

<p>The problem seems to be a result of the fact that DialerLayout.onMeasure sets canShowList but when the DialerFragment initializes, it calls DialerLayout.canShowList() before DialerLayouer.onMeasure has a chance to initialize the variable, resulting in an empty list of contacts.</p>

<p>Here is a proposed solution which allows DialerLayout to notify DialerFragment anytime the value of canShowList 
is changed.</p>

<h1>Index: src/com/csipsimple/ui/dialpad/DialerLayout.java</h1>

<p>--- src/com/csipsimple/ui/dialpad/DialerLayout.java (revision 2096)
+++ src/com/csipsimple/ui/dialpad/DialerLayout.java (working copy)
@@ -45,7 +45,19 @@
     private boolean canShowList = false;</p>

<pre><code> private float expectedBtnHeightFactor;
</code></pre>

<p>+ <br>
+    private OnAutoCompleteListVisibilityChangedListener onAutoCompleteListVisibilityChangedListener;
+    public void setAutoCompleteListVisibiltyChangedListener(OnAutoCompleteListVisibilityChangedListener listener) {
+       onAutoCompleteListVisibilityChangedListener = listener;
+    }</p>

<ul>
<li>/**</li>
<li><ul><li>Interface for notifying listeners when the value of canShowList changes</li></ul></li>
<li>*/</li>
<li>public interface OnAutoCompleteListVisibilityChangedListener {</li>
<li>public void onAutoCompleteListVisibiltyChanged();</li>
<li><p>} <br>
+
 public DialerLayout(Context context) {
     super(context);
     init();
@@ -97,6 +109,9 @@
         dialerCallBar.setLayoutParams(lp);
     }</p></li>
<li><p>// remember the current state of canShowList</p></li>
<li>boolean previousState = canShowList;
+
     if(!forceNoList &amp;&amp; 
             height &gt; (LIST_BTNS_HEIGHT + LIST_DIALPAD_HEIGHT + LIST_DIGITS_HEIGHT + LIST_MIN_HEIGHT)* density ) {
@@ -127,6 +142,11 @@
     }else {
         canShowList = false;
     }
+</li>
<li>// if the state of canShowList has changed and we have a listener then notify it</li>
<li>if (previousState != canShowList &amp;&amp; onAutoCompleteListVisibilityChangedListener != null) {</li>
<li>onAutoCompleteListVisibilityChangedListener.onAutoCompleteListVisibiltyChanged();</li>
<li>}
     super.onMeasure(widthMeasureSpec, heightMeasureSpec);
 }</li>
</ul>

<h1>Index: src/com/csipsimple/ui/dialpad/DialerFragment.java</h1>

<p>--- src/com/csipsimple/ui/dialpad/DialerFragment.java   (revision 2096)
+++ src/com/csipsimple/ui/dialpad/DialerFragment.java   (working copy)
@@ -73,6 +73,7 @@
 import com.csipsimple.api.SipManager;
 import com.csipsimple.api.SipProfile;
 import com.csipsimple.ui.SipHome.ViewPagerVisibilityListener;
+import com.csipsimple.ui.dialpad.DialerLayout.OnAutoCompleteListVisibilityChangedListener;
 import com.csipsimple.utils.CallHandlerPlugin;
 import com.csipsimple.utils.CallHandlerPlugin.OnLoadListener;
 import com.csipsimple.utils.DialingFeedback;
@@ -88,7 +89,8 @@
 import com.csipsimple.widgets.Dialpad.OnDialKeyListener;</p>

<p>public class DialerFragment extends SherlockFragment implements OnClickListener, OnLongClickListener,
-        OnDialKeyListener, TextWatcher, OnDialActionListener, ViewPagerVisibilityListener, OnKeyListener {
+        OnDialKeyListener, TextWatcher, OnDialActionListener, ViewPagerVisibilityListener, OnKeyListener,
+        OnAutoCompleteListVisibilityChangedListener {</p>

<pre><code> private static final String THIS_FILE = &amp;quot;DialerFragment&amp;quot;;
</code></pre>

<p>@@ -155,6 +157,10 @@</p>

<pre><code> private DialerLayout dialerLayout;
</code></pre>

<ul>
<li>@Override</li>
<li>public void onAutoCompleteListVisibiltyChanged() {</li>
<li>applyTextToAutoComplete();</li>
<li><p>}</p>

<p>@Override
 public void onCreate(Bundle savedInstanceState) {
@@ -204,11 +210,12 @@</p>

<pre><code> // Layout 
 dialerLayout.setForceNoList(mDualPane);
</code></pre></li>
<li><p>dialerLayout.setAutoCompleteListVisibiltyChangedListener(this);</p>

<pre><code> // Account chooser button setup
 accountChooserButton.setShowExternals(true);
</code></pre>

<h2>         accountChooserButton.setOnAccountChangeListener(accountButtonChangeListener);</h2></li>
<li><pre><code> // Dialpad
 dialPad.setOnDialKeyListener(this);
</code></pre></li>
</ul></markdown-widget>
              </span><!-- end ngIf: comment.content -->
              <!-- ngIf: !comment.content -->

              <!-- ngIf: comment.attachments.length -->
              <!-- ngRepeat: attachment in comment.attachments -->
            </div><!-- end ngRepeat: comment in issueCtrl.issue.comments --><div ng-repeat="comment in issueCtrl.issue.comments" class="ng-scope">
              <div>
                <!-- ngIf: comment.id --><h3 ng-if="comment.id" class="ng-binding ng-scope">Comment #1</h3><!-- end ngIf: comment.id -->
                <!-- ms to seconds. -->
                <small class="ng-binding">
                  Posted on Mar 9, 2013 by
                  <i class="ng-binding">Quick Hippo</i>
                </small>
              </div>

              <!-- TODO(chrsmith): Get the formatting right. Google Code comments
              are not stored in wiki/markdown or HTML format. So we probably need to
              create a custom filter to get 100% paritiy. -->
              <!-- ngIf: comment.content --><span ng-if="comment.content" class="ng-scope">
                <markdown-widget text="comment.content" class="markdown"><p>This issue was closed by revision r2157.</p></markdown-widget>
              </span><!-- end ngIf: comment.content -->
              <!-- ngIf: !comment.content -->

              <!-- ngIf: comment.attachments.length -->
              <!-- ngRepeat: attachment in comment.attachments -->
            </div><!-- end ngRepeat: comment in issueCtrl.issue.comments --><div ng-repeat="comment in issueCtrl.issue.comments" class="ng-scope">
              <div>
                <!-- ngIf: comment.id --><h3 ng-if="comment.id" class="ng-binding ng-scope">Comment #2</h3><!-- end ngIf: comment.id -->
                <!-- ms to seconds. -->
                <small class="ng-binding">
                  Posted on Mar 9, 2013 by
                  <i class="ng-binding">Quick Hippo</i>
                </small>
              </div>

              <!-- TODO(chrsmith): Get the formatting right. Google Code comments
              are not stored in wiki/markdown or HTML format. So we probably need to
              create a custom filter to get 100% paritiy. -->
              <!-- ngIf: comment.content --><span ng-if="comment.content" class="ng-scope">
                <markdown-widget text="comment.content" class="markdown"><p>Fix added.</p>

<p>Thanks a lot for the patch !</p>

<p>BTW, I've also added something to fix the full dual pane mode.</p></markdown-widget>
              </span><!-- end ngIf: comment.content -->
              <!-- ngIf: !comment.content -->

              <!-- ngIf: comment.attachments.length -->
              <!-- ngRepeat: attachment in comment.attachments -->
            </div><!-- end ngRepeat: comment in issueCtrl.issue.comments -->
          </div>

          <!-- Sidebar with additional information -->
          <div class="maia-col-4">
            <div class="maia-aside">
              <p>Status: <code class="ng-binding">Fixed</code></p>
              <!-- ngIf: issueCtrl.issue.labels.length > 0 --><p ng-if="issueCtrl.issue.labels.length &gt; 0" class="ng-scope">
                Labels:
                <br>
                <!-- ngRepeat: label in issueCtrl.issue.labels track by $index --><span ng-repeat="label in issueCtrl.issue.labels track by $index" class="ng-scope">
                  <span class="gca-label ng-binding">Type-Defect</span>
                </span><!-- end ngRepeat: label in issueCtrl.issue.labels track by $index --><span ng-repeat="label in issueCtrl.issue.labels track by $index" class="ng-scope">
                  <span class="gca-label ng-binding">Priority-Medium</span>
                </span><!-- end ngRepeat: label in issueCtrl.issue.labels track by $index -->
              </p><!-- end ngIf: issueCtrl.issue.labels.length > 0 -->
            </div>
          </div>
        </div><!-- end ngIf: !issueCtrl.error -->
      </div>
    </div>

  </div>
</div>
</div></div></div>
    <noscript>
      &lt;p&gt;The Google Code Archive requires JavaScript to be enabled in your browser.&lt;/p&gt;
    </noscript>

    <div id="maia-signature"></div>
    <div class="maia-footer" id="maia-footer">
      <div id="maia-footer-local">
      </div>
      <div id="maia-footer-global">
        <div class="maia-aux">
          <ul>
            <li>
              <a href="//www.google.com/">Google</a>
            </li>
            <li>
              <a href="//www.google.com/intl/en/about/">About Google</a>
            </li>
            <li>
              <a href="//www.google.com/intl/en/policies/privacy/">Privacy</a>
            </li>
            <li>
              <a href="//www.google.com/intl/en/policies/terms/">Terms</a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <script src="//www.google.com/js/maia.js"></script>
  


</body></html>