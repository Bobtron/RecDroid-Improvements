https://code.google.com/archive/p/csipsimple/issues/2380<!DOCTYPE html><html class="google ng-scope" lang="en" ng-app="codesiteArchive.application"><head>
    <meta charset="utf-8">
    <meta content="initial-scale=1, minimum-scale=1, width=device-width" name="viewport">

    <!-- https://developers.google.com/webmasters/ajax-crawling/docs/specification -->
    <meta name="fragment" content="!">
    <title>Google Code Archive - Long-term storage for Google Code Project Hosting.</title>

    <link rel="icon" type="image/vnd.microsoft.icon" href="/archive/img/project-hosting.ico">
    <script src="//www.google.com/js/google.js"></script>
    <link href="//www.google.com/css/maia.css" rel="stylesheet">
    <link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,600,700&amp;lang=en" rel="stylesheet">
    <link rel="stylesheet" href="/archive/archive_css.css">
    <script>
      CLOSURE_NO_DEPS = true;
    </script>
    <script src="/archive/angular.js"></script><style type="text/css">@charset "UTF-8";

[ng\:cloak], [ng-cloak], [data-ng-cloak], [x-ng-cloak],
.ng-cloak, .x-ng-cloak,
.ng-hide:not(.ng-hide-animate) {
  display: none !important;
}

ng\:form {
  display: block;
}

.ng-animate-shim {
  visibility:hidden;
}

.ng-anchor {
  position:absolute;
}
</style>
    <script src="/archive/pagedown.js"></script>
    <script src="/archive/archive.js"></script>
    <base href="/archive/">
  </head>

  <body>
    <div class="maia-header" id="maia-header" role="banner">
      <div class="maia-aux">
        <a href="/archive/">
          </a><h1><a href="/archive/">
            <img alt="Google" src="//www.google.com/images/branding/googlelogo/1x/googlelogo_color_116x41dp.png"> Code</a>
          </h1>
        
        <a href="/archive/">
          <h2>Archive</h2>
        </a>
        <a class="maia-teleport" href="#content">Skip to content</a>
        <div class="maia-util">
          <form action="/archive/search" class="maia-search ng-pristine ng-valid">
            <input name="q" placeholder="Search this site" type="text">
            <button class="maia-button">
              <span class="maia-search-icon">Search</span>
            </button>
          </form>
        </div>
      </div>
    </div>

    <!-- ngView: --><div ng-view="" class="ng-scope"><div ng-controller="ProjectIssueCtrl as issueCtrl" class="ng-scope">
<nav-bar-widget nav-level-1="projectCtrl.navLevel1" class="ng-isolate-scope"><div class="maia-nav maia-complex" id="maia-nav-x" role="navigation">
  <div class="maia-aux">
    <ul>
      <li ng-class="{active: navLevel1 == 'projects'}">
        <a href="/archive/">Projects</a>
        <!-- ngIf: navLevel2 -->
      </li>
      <li ng-class="{active: navLevel1 == 'search'}">
        <a href="/archive/search">Search</a>
      </li>
      <li ng-class="{active: navLevel1 == 'about'}">
        <a href="/archive/about">About</a>
      </li>
    </ul>
  </div>
</div>
</nav-bar-widget>
<div id="maia-main" role="main">

  <!-- ngIf: issueCtrl.notFound -->

  <div ng-hide="issueCtrl.notFound">
    <!-- Left-side resource nav -->
    <project-resources-widget domain="issueCtrl.domain" project="issueCtrl.projectName" class="ng-isolate-scope"><div class="maia-nav" id="maia-nav-y" role="navigation">
  <!-- ngIf: domain == 'code.google.com' --><ul ng-if="domain == 'code.google.com'" class="ng-scope">
    <li class="active">
      <a href="/archive/p/csipsimple/">Project</a>
    </li>
    <li>
      <a href="/archive/p/csipsimple/source">Source</a>
    </li>
    <li>
      <a href="/archive/p/csipsimple/issues">Issues</a>
    </li>
    <li>
      <a href="/archive/p/csipsimple/wikis">Wikis</a>
    </li>
    <li>
      <a href="/archive/p/csipsimple/downloads">Downloads</a>
    </li>
  </ul><!-- end ngIf: domain == 'code.google.com' -->

    <!-- ngIf: domain != 'code.google.com' -->
</div></project-resources-widget>

    <div class="maia-article" role="article">
      <div class="maia-teleport" id="content"></div>
      <div class="maia-cols">
        <div id="gca-project-header" class="maia-col-10">
          <a id="gca-export-to-gh" class="maia-button" href="https://code.google.com/export-to-github/export?project=csipsimple">Export to GitHub</a>
            <img class="gca-project-logo" src="https://storage.googleapis.com/google-code-archive/v2/code.google.com/csipsimple/logo.png">
            <h1 class="ng-binding">csipsimple - issue #2380</h1>
            <p class="ng-binding">Error while registering - Forbidden - Digest Authentication fails on 4.2.2</p>
        </div>

        <div class="maia-col-10">
          <hr>

        <!-- ngIf: issueCtrl.error -->

        <!-- ngIf: !issueCtrl.error --><div ng-if="!issueCtrl.error" class="ng-scope">
          <!-- Comments -->
          <div class="maia-col-8">
            <!-- ngRepeat: comment in issueCtrl.issue.comments --><div ng-repeat="comment in issueCtrl.issue.comments" class="ng-scope">
              <div>
                <!-- ngIf: comment.id -->
                <!-- ms to seconds. -->
                <small class="ng-binding">
                  Posted on May 30, 2013 by
                  <i class="ng-binding">Grumpy Monkey</i>
                </small>
              </div>

              <!-- TODO(chrsmith): Get the formatting right. Google Code comments
              are not stored in wiki/markdown or HTML format. So we probably need to
              create a custom filter to get 100% paritiy. -->
              <!-- ngIf: comment.content --><span ng-if="comment.content" class="ng-scope">
                <markdown-widget text="comment.content" class="markdown"><p><b>What steps will reproduce the problem?</b>
1. configure SIP profile to be used with CiscoUCM 6.1
2. replicate seme exact profile, config and credentials used successfully on a 4.1.1 Galaxy S3 to a new 4.2.2 Galaxy S4
3. verify every single parameter several times, including network configuration</p>

<p><b>What is the expected output? What do you see instead?</b>
I would expect the phone to register instead I get "Error while registering - Forbidden"</p>

<p><b>What version of the product are you using? On what device / operating</b>
<b>system?</b>
1.00.00 r2225 on a Galaxy S4 running Android 4.2.2</p>

<p><b>Please provide any additional information below.</b>
I compared the diagnostic logging between the two phone and everything looks the same, but on the S4 (same exact version of csipsimple with same exact credentials) the digest authentication fails..</p>

<p>D/libpjsip( 5437): Authorization: Digest username="lnonino", realm="ccmsipline", nonce="7NqmdRCT3VWP+Ch9muYQcJoDLBP0Lzvc", uri="sip:192.168.111.9", response="c14680db224164f383f5e9e01187904d", algorithm=MD5
D/libpjsip( 5437): Content-Length:  0
D/libpjsip( 5437): 
D/libpjsip( 5437): --end msg--
D/libpjsip( 5437): 10:09:46.239   pjsua_core.c  .RX 366 bytes Response msg 100/REGISTER/cseq=19739 (rdata0x6d147f5c) from UDP 192.168.111.9:5060:
D/libpjsip( 5437): SIP/2.0 100 Trying
D/libpjsip( 5437): Date: Mon, 30 May 2005 14:09:29 GMT
D/libpjsip( 5437): From: "2959" &lt;sip:2959@192.168.111.9&gt;;tag=LP3Xp7tKwUkfXpIqsbo0e1jXP1ZzsVAc
D/libpjsip( 5437): Content-Length: 0
D/libpjsip( 5437): To: "2959" &lt;sip:2959@192.168.111.9&gt;;tag=1495640922
D/libpjsip( 5437): Call-ID: rd1BdHfRVU4-nx1InJICb1S5tzE.7VbU
D/libpjsip( 5437): Via: SIP/2.0/UDP 192.168.116.228:57394;rport;branch=z9hG4bKPjGV2vveyVcm61elex.Wb54copZPxu1aFA
D/libpjsip( 5437): CSeq: 19739 REGISTER
D/libpjsip( 5437): 
D/libpjsip( 5437): --end msg--
D/libpjsip( 5437): 10:09:46.239 mobile_reg_han  .mod_reg_tracker_on_rx_response
D/libpjsip( 5437): 10:09:46.239 mobile_reg_han  .mod_reg_tracker_on_rx_response done
D/libpjsip( 5437): 10:09:46.244   pjsua_core.c  .RX 422 bytes Response msg 403/REGISTER/cseq=19739 (rdata0x6d147f5c) from UDP 192.168.111.9:5060:
D/libpjsip( 5437): SIP/2.0 403 Forbidden
D/libpjsip( 5437): Date: Mon, 30 May 2005 14:09:29 GMT
D/libpjsip( 5437): Warning: 399 cmsub1 "Digest authentication failure"</p>

<p>It looks like an issue with properly executing the Digest authentication under 4.2.2. Is there any workaround or does it need to be fixed in the code?</p>

<p>Thank you in advance,
Sergio Tagliapietra</p></markdown-widget>
              </span><!-- end ngIf: comment.content -->
              <!-- ngIf: !comment.content -->

              <!-- ngIf: comment.attachments.length -->
              <!-- ngRepeat: attachment in comment.attachments -->
            </div><!-- end ngRepeat: comment in issueCtrl.issue.comments --><div ng-repeat="comment in issueCtrl.issue.comments" class="ng-scope">
              <div>
                <!-- ngIf: comment.id --><h3 ng-if="comment.id" class="ng-binding ng-scope">Comment #1</h3><!-- end ngIf: comment.id -->
                <!-- ms to seconds. -->
                <small class="ng-binding">
                  Posted on May 30, 2013 by
                  <i class="ng-binding">Grumpy Monkey</i>
                </small>
              </div>

              <!-- TODO(chrsmith): Get the formatting right. Google Code comments
              are not stored in wiki/markdown or HTML format. So we probably need to
              create a custom filter to get 100% paritiy. -->
              <!-- ngIf: comment.content --><span ng-if="comment.content" class="ng-scope">
                <markdown-widget text="comment.content" class="markdown"><p>ps: I now also tested it against a CallManager 5.1.3.5000-3 cluster with exactly the same error. I can use that cluster with the same exact release of csipsimple and configuration on a 4.1.1 Galaxy S3. I hoped to find errors in my setup but after testing for a couple of days I feel confident that this is a software glitch. Thanks and let me know if you have a quick suggestion on how to rectify this.</p></markdown-widget>
              </span><!-- end ngIf: comment.content -->
              <!-- ngIf: !comment.content -->

              <!-- ngIf: comment.attachments.length -->
              <!-- ngRepeat: attachment in comment.attachments -->
            </div><!-- end ngRepeat: comment in issueCtrl.issue.comments --><div ng-repeat="comment in issueCtrl.issue.comments" class="ng-scope">
              <div>
                <!-- ngIf: comment.id --><h3 ng-if="comment.id" class="ng-binding ng-scope">Comment #2</h3><!-- end ngIf: comment.id -->
                <!-- ms to seconds. -->
                <small class="ng-binding">
                  Posted on May 30, 2013 by
                  <i class="ng-binding">Grumpy Monkey</i>
                </small>
              </div>

              <!-- TODO(chrsmith): Get the formatting right. Google Code comments
              are not stored in wiki/markdown or HTML format. So we probably need to
              create a custom filter to get 100% paritiy. -->
              <!-- ngIf: comment.content --><span ng-if="comment.content" class="ng-scope">
                <markdown-widget text="comment.content" class="markdown"><p>I wonder if it's because of the changes in SecureRandom under Android 4.2.. ? <a href="http://android-developers.blogspot.com/2013/02/security-enhancements-in-jelly-bean.html">http://android-developers.blogspot.com/2013/02/security-enhancements-in-jelly-bean.html</a></p></markdown-widget>
              </span><!-- end ngIf: comment.content -->
              <!-- ngIf: !comment.content -->

              <!-- ngIf: comment.attachments.length -->
              <!-- ngRepeat: attachment in comment.attachments -->
            </div><!-- end ngRepeat: comment in issueCtrl.issue.comments --><div ng-repeat="comment in issueCtrl.issue.comments" class="ng-scope">
              <div>
                <!-- ngIf: comment.id --><h3 ng-if="comment.id" class="ng-binding ng-scope">Comment #3</h3><!-- end ngIf: comment.id -->
                <!-- ms to seconds. -->
                <small class="ng-binding">
                  Posted on May 31, 2013 by
                  <i class="ng-binding">Quick Hippo</i>
                </small>
              </div>

              <!-- TODO(chrsmith): Get the formatting right. Google Code comments
              are not stored in wiki/markdown or HTML format. So we probably need to
              create a custom filter to get 100% paritiy. -->
              <!-- ngIf: comment.content --><span ng-if="comment.content" class="ng-scope">
                <markdown-widget text="comment.content" class="markdown"><p>Mmmmh, your last point is interesting for other problems and can normally be workaround with the fullOpenSSL version (a version that bundle openssl)
<a href="http://nightlies.csipsimple.com/specific_builds/CSipSimple-fullOpenSSL.apk">http://nightlies.csipsimple.com/specific_builds/CSipSimple-fullOpenSSL.apk</a></p>

<p>But normally for the digest authentication openssl is not used (it's used for ZRTP and TLS but for digest auth it's just a md5).</p>

<p>So you can try the fullOpenSSL version but I doubt it will help.</p>

<p>The only other potential root cause of this kind of problem is usually a password or auth username not valid (what happens very often is to have the keyboard of the phone that changes the cases/auto-complete something wrong or add extra spaces). But if you checked several times, it's maybe something else.</p>

<p>What you could try to be sure you have exactly same configuration is to backup the configuration from your S3 (in accounts &gt; menu &gt; backup) and get the file exported on the sdcard (remove it while you get it from the S3 sdcard for better security). And then put this file on the sdcard of the S4 (in same folder). And then on the S4, in accounts &gt; menu &gt; restore the file from the sdcard (and remove the file from the sdcard once restored for better security)</p></markdown-widget>
              </span><!-- end ngIf: comment.content -->
              <!-- ngIf: !comment.content -->

              <!-- ngIf: comment.attachments.length -->
              <!-- ngRepeat: attachment in comment.attachments -->
            </div><!-- end ngRepeat: comment in issueCtrl.issue.comments --><div ng-repeat="comment in issueCtrl.issue.comments" class="ng-scope">
              <div>
                <!-- ngIf: comment.id --><h3 ng-if="comment.id" class="ng-binding ng-scope">Comment #4</h3><!-- end ngIf: comment.id -->
                <!-- ms to seconds. -->
                <small class="ng-binding">
                  Posted on May 31, 2013 by
                  <i class="ng-binding">Grumpy Monkey</i>
                </small>
              </div>

              <!-- TODO(chrsmith): Get the formatting right. Google Code comments
              are not stored in wiki/markdown or HTML format. So we probably need to
              create a custom filter to get 100% paritiy. -->
              <!-- ngIf: comment.content --><span ng-if="comment.content" class="ng-scope">
                <markdown-widget text="comment.content" class="markdown"><p>I was saddened by seeing this issue closed as I strongly believe it's a
real issue.
Believe me, I tried with several different acount and on different CUCM
clusters and the credentials are absolutely and 101% correct; there is
something that gets the authentication to fail on the S4 but I can't say
what it is.
Any other idea?
(I'm an ex network administrator and now IT Manager for a multinational
corporation with 8+ years of experience in VOIP systems; I'm not a
programmer but please believe me when I say that the configuration is
correct).
Thanks.. I hope you have some other ideas/suggestions.
Sergio
ps: also.. I'm actually not the only user reporting this. I believe issue
2356 has probably the same exact cause</p></markdown-widget>
              </span><!-- end ngIf: comment.content -->
              <!-- ngIf: !comment.content -->

              <!-- ngIf: comment.attachments.length -->
              <!-- ngRepeat: attachment in comment.attachments -->
            </div><!-- end ngRepeat: comment in issueCtrl.issue.comments --><div ng-repeat="comment in issueCtrl.issue.comments" class="ng-scope">
              <div>
                <!-- ngIf: comment.id --><h3 ng-if="comment.id" class="ng-binding ng-scope">Comment #5</h3><!-- end ngIf: comment.id -->
                <!-- ms to seconds. -->
                <small class="ng-binding">
                  Posted on Oct 2, 2013 by
                  <i class="ng-binding">Massive Horse</i>
                </small>
              </div>

              <!-- TODO(chrsmith): Get the formatting right. Google Code comments
              are not stored in wiki/markdown or HTML format. So we probably need to
              create a custom filter to get 100% paritiy. -->
              <!-- ngIf: comment.content --><span ng-if="comment.content" class="ng-scope">
                <markdown-widget text="comment.content" class="markdown"><p>Error while registering - Forbidden:</p>

<p>Using a password without non-alphanumericals like ". , !" etc. solved the issue for me. Nothing wrong with CSIP or Android 4.2x here. Still slightly astonishing as 6 months earlier non-alphanumericals were accepted for passwords. </p>

<p>Cheers</p>

<p>Gregor</p></markdown-widget>
              </span><!-- end ngIf: comment.content -->
              <!-- ngIf: !comment.content -->

              <!-- ngIf: comment.attachments.length -->
              <!-- ngRepeat: attachment in comment.attachments -->
            </div><!-- end ngRepeat: comment in issueCtrl.issue.comments --><div ng-repeat="comment in issueCtrl.issue.comments" class="ng-scope">
              <div>
                <!-- ngIf: comment.id --><h3 ng-if="comment.id" class="ng-binding ng-scope">Comment #6</h3><!-- end ngIf: comment.id -->
                <!-- ms to seconds. -->
                <small class="ng-binding">
                  Posted on Oct 2, 2013 by
                  <i class="ng-binding">Grumpy Monkey</i>
                </small>
              </div>

              <!-- TODO(chrsmith): Get the formatting right. Google Code comments
              are not stored in wiki/markdown or HTML format. So we probably need to
              create a custom filter to get 100% paritiy. -->
              <!-- ngIf: comment.content --><span ng-if="comment.content" class="ng-scope">
                <markdown-widget text="comment.content" class="markdown"><p>My password just had numbers and lowercase letters really..</p></markdown-widget>
              </span><!-- end ngIf: comment.content -->
              <!-- ngIf: !comment.content -->

              <!-- ngIf: comment.attachments.length -->
              <!-- ngRepeat: attachment in comment.attachments -->
            </div><!-- end ngRepeat: comment in issueCtrl.issue.comments --><div ng-repeat="comment in issueCtrl.issue.comments" class="ng-scope">
              <div>
                <!-- ngIf: comment.id --><h3 ng-if="comment.id" class="ng-binding ng-scope">Comment #7</h3><!-- end ngIf: comment.id -->
                <!-- ms to seconds. -->
                <small class="ng-binding">
                  Posted on Oct 16, 2013 by
                  <i class="ng-binding">Grumpy Bird</i>
                </small>
              </div>

              <!-- TODO(chrsmith): Get the formatting right. Google Code comments
              are not stored in wiki/markdown or HTML format. So we probably need to
              create a custom filter to get 100% paritiy. -->
              <!-- ngIf: comment.content --><span ng-if="comment.content" class="ng-scope">
                <markdown-widget text="comment.content" class="markdown"><p>I have the same issue with Android 4.1.1 and Call Manager 8.6: I get Digest Authentication failure. I've tried with a Sony Xperia E. With SIPDroip same digest worked fine. I've tried first with a password with non-alphanumericals, and then changed to one with lowercase and numbers only with same result.
Did you finally manage to solve the problem?</p>

<p>Thanks in advance,</p>

<p>Natalia</p></markdown-widget>
              </span><!-- end ngIf: comment.content -->
              <!-- ngIf: !comment.content -->

              <!-- ngIf: comment.attachments.length -->
              <!-- ngRepeat: attachment in comment.attachments -->
            </div><!-- end ngRepeat: comment in issueCtrl.issue.comments --><div ng-repeat="comment in issueCtrl.issue.comments" class="ng-scope">
              <div>
                <!-- ngIf: comment.id --><h3 ng-if="comment.id" class="ng-binding ng-scope">Comment #8</h3><!-- end ngIf: comment.id -->
                <!-- ms to seconds. -->
                <small class="ng-binding">
                  Posted on Dec 10, 2014 by
                  <i class="ng-binding">Happy Horse</i>
                </small>
              </div>

              <!-- TODO(chrsmith): Get the formatting right. Google Code comments
              are not stored in wiki/markdown or HTML format. So we probably need to
              create a custom filter to get 100% paritiy. -->
              <!-- ngIf: comment.content --><span ng-if="comment.content" class="ng-scope">
                <markdown-widget text="comment.content" class="markdown"><p>Hi,
I have the same issue and I am giving alphanumeric password only still giving same error. Could you please help me in this.
this is my error.....
17:54:26.730    pjsua_acc.c  ....SIP registration error: Credential failed to authenticate (PJSIP_EFAILEDCREDENTIAL) [status=171100]</p>

<p>Thanks,
Sachin</p></markdown-widget>
              </span><!-- end ngIf: comment.content -->
              <!-- ngIf: !comment.content -->

              <!-- ngIf: comment.attachments.length -->
              <!-- ngRepeat: attachment in comment.attachments -->
            </div><!-- end ngRepeat: comment in issueCtrl.issue.comments -->
          </div>

          <!-- Sidebar with additional information -->
          <div class="maia-col-4">
            <div class="maia-aside">
              <p>Status: <code class="ng-binding">Need-Details</code></p>
              <!-- ngIf: issueCtrl.issue.labels.length > 0 --><p ng-if="issueCtrl.issue.labels.length &gt; 0" class="ng-scope">
                Labels:
                <br>
                <!-- ngRepeat: label in issueCtrl.issue.labels track by $index --><span ng-repeat="label in issueCtrl.issue.labels track by $index" class="ng-scope">
                  <span class="gca-label ng-binding">Type-Defect</span>
                </span><!-- end ngRepeat: label in issueCtrl.issue.labels track by $index --><span ng-repeat="label in issueCtrl.issue.labels track by $index" class="ng-scope">
                  <span class="gca-label ng-binding">Priority-Medium</span>
                </span><!-- end ngRepeat: label in issueCtrl.issue.labels track by $index -->
              </p><!-- end ngIf: issueCtrl.issue.labels.length > 0 -->
            </div>
          </div>
        </div><!-- end ngIf: !issueCtrl.error -->
      </div>
    </div>

  </div>
</div>
</div></div></div>
    <noscript>
      &lt;p&gt;The Google Code Archive requires JavaScript to be enabled in your browser.&lt;/p&gt;
    </noscript>

    <div id="maia-signature"></div>
    <div class="maia-footer" id="maia-footer">
      <div id="maia-footer-local">
      </div>
      <div id="maia-footer-global">
        <div class="maia-aux">
          <ul>
            <li>
              <a href="//www.google.com/">Google</a>
            </li>
            <li>
              <a href="//www.google.com/intl/en/about/">About Google</a>
            </li>
            <li>
              <a href="//www.google.com/intl/en/policies/privacy/">Privacy</a>
            </li>
            <li>
              <a href="//www.google.com/intl/en/policies/terms/">Terms</a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <script src="//www.google.com/js/maia.js"></script>
  


</body></html>