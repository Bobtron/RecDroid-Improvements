https://code.google.com/archive/p/csipsimple/issues/2315<!DOCTYPE html><html class="google ng-scope" lang="en" ng-app="codesiteArchive.application"><head>
    <meta charset="utf-8">
    <meta content="initial-scale=1, minimum-scale=1, width=device-width" name="viewport">

    <!-- https://developers.google.com/webmasters/ajax-crawling/docs/specification -->
    <meta name="fragment" content="!">
    <title>Google Code Archive - Long-term storage for Google Code Project Hosting.</title>

    <link rel="icon" type="image/vnd.microsoft.icon" href="/archive/img/project-hosting.ico">
    <script src="//www.google.com/js/google.js"></script>
    <link href="//www.google.com/css/maia.css" rel="stylesheet">
    <link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,600,700&amp;lang=en" rel="stylesheet">
    <link rel="stylesheet" href="/archive/archive_css.css">
    <script>
      CLOSURE_NO_DEPS = true;
    </script>
    <script src="/archive/angular.js"></script><style type="text/css">@charset "UTF-8";

[ng\:cloak], [ng-cloak], [data-ng-cloak], [x-ng-cloak],
.ng-cloak, .x-ng-cloak,
.ng-hide:not(.ng-hide-animate) {
  display: none !important;
}

ng\:form {
  display: block;
}

.ng-animate-shim {
  visibility:hidden;
}

.ng-anchor {
  position:absolute;
}
</style>
    <script src="/archive/pagedown.js"></script>
    <script src="/archive/archive.js"></script>
    <base href="/archive/">
  </head>

  <body>
    <div class="maia-header" id="maia-header" role="banner">
      <div class="maia-aux">
        <a href="/archive/">
          </a><h1><a href="/archive/">
            <img alt="Google" src="//www.google.com/images/branding/googlelogo/1x/googlelogo_color_116x41dp.png"> Code</a>
          </h1>
        
        <a href="/archive/">
          <h2>Archive</h2>
        </a>
        <a class="maia-teleport" href="#content">Skip to content</a>
        <div class="maia-util">
          <form action="/archive/search" class="maia-search ng-pristine ng-valid">
            <input name="q" placeholder="Search this site" type="text">
            <button class="maia-button">
              <span class="maia-search-icon">Search</span>
            </button>
          </form>
        </div>
      </div>
    </div>

    <!-- ngView: --><div ng-view="" class="ng-scope"><div ng-controller="ProjectIssueCtrl as issueCtrl" class="ng-scope">
<nav-bar-widget nav-level-1="projectCtrl.navLevel1" class="ng-isolate-scope"><div class="maia-nav maia-complex" id="maia-nav-x" role="navigation">
  <div class="maia-aux">
    <ul>
      <li ng-class="{active: navLevel1 == 'projects'}">
        <a href="/archive/">Projects</a>
        <!-- ngIf: navLevel2 -->
      </li>
      <li ng-class="{active: navLevel1 == 'search'}">
        <a href="/archive/search">Search</a>
      </li>
      <li ng-class="{active: navLevel1 == 'about'}">
        <a href="/archive/about">About</a>
      </li>
    </ul>
  </div>
</div>
</nav-bar-widget>
<div id="maia-main" role="main">

  <!-- ngIf: issueCtrl.notFound -->

  <div ng-hide="issueCtrl.notFound">
    <!-- Left-side resource nav -->
    <project-resources-widget domain="issueCtrl.domain" project="issueCtrl.projectName" class="ng-isolate-scope"><div class="maia-nav" id="maia-nav-y" role="navigation">
  <!-- ngIf: domain == 'code.google.com' --><ul ng-if="domain == 'code.google.com'" class="ng-scope">
    <li class="active">
      <a href="/archive/p/csipsimple/">Project</a>
    </li>
    <li>
      <a href="/archive/p/csipsimple/source">Source</a>
    </li>
    <li>
      <a href="/archive/p/csipsimple/issues">Issues</a>
    </li>
    <li>
      <a href="/archive/p/csipsimple/wikis">Wikis</a>
    </li>
    <li>
      <a href="/archive/p/csipsimple/downloads">Downloads</a>
    </li>
  </ul><!-- end ngIf: domain == 'code.google.com' -->

    <!-- ngIf: domain != 'code.google.com' -->
</div></project-resources-widget>

    <div class="maia-article" role="article">
      <div class="maia-teleport" id="content"></div>
      <div class="maia-cols">
        <div id="gca-project-header" class="maia-col-10">
          <a id="gca-export-to-gh" class="maia-button" href="https://code.google.com/export-to-github/export?project=csipsimple">Export to GitHub</a>
            <img class="gca-project-logo" src="https://storage.googleapis.com/google-code-archive/v2/code.google.com/csipsimple/logo.png">
            <h1 class="ng-binding">csipsimple - issue #2315</h1>
            <p class="ng-binding">Cannot make calls over VPN connection</p>
        </div>

        <div class="maia-col-10">
          <hr>

        <!-- ngIf: issueCtrl.error -->

        <!-- ngIf: !issueCtrl.error --><div ng-if="!issueCtrl.error" class="ng-scope">
          <!-- Comments -->
          <div class="maia-col-8">
            <!-- ngRepeat: comment in issueCtrl.issue.comments --><div ng-repeat="comment in issueCtrl.issue.comments" class="ng-scope">
              <div>
                <!-- ngIf: comment.id -->
                <!-- ms to seconds. -->
                <small class="ng-binding">
                  Posted on Apr 9, 2013 by
                  <i class="ng-binding">Helpful Dog</i>
                </small>
              </div>

              <!-- TODO(chrsmith): Get the formatting right. Google Code comments
              are not stored in wiki/markdown or HTML format. So we probably need to
              create a custom filter to get 100% paritiy. -->
              <!-- ngIf: comment.content --><span ng-if="comment.content" class="ng-scope">
                <markdown-widget text="comment.content" class="markdown"><p>Using CSipSimple_yecon77_mg789_tb_ics2-15/r2187
(and any earlier releases) could not make calls using VPN connection.
I am using it on Android ICS ver. 4.0.4, ZTE e-Learning PAD E7
I have WiFi connection at home, it gives me IP 192.168.5.33 255.255.255.0
I have L2TP/IPSec VPN server at work, after connection it gives me 
IP 10.1.3.2 255.255.0.0 (may be changed on next connection)
We have SIP server inside  corporate local network with IP 10.1.7.202 255.255.0.0.
I can successfully login to my SIP account and dial phone numbers.
Called phone acceptes call, but because no data stream establised, 
connection is dropped.
As I uderstand, it is because CSipSimple wrongly sets 192.168.5.33 as voice data interface, instead of 10.1.3.2, wich is on same network as SIP server.</p>

<p>Because as I see, no attachments now possible, I will show short part of log file fore one session:</p>

<p>D/libpjsip( 2280): 16:39:08.602   pjsua_core.c !.TX 1051 bytes Request msg INVITE/cseq=29000 (tdta0xe6f648) to UDP 10.1.7.202:5060:
D/libpjsip( 2280): INVITE sip:84957833444@10.1.7.202 SIP/2.0
D/libpjsip( 2280): Via: SIP/2.0/UDP 192.168.5.33:55079;rport;branch=z9hG4bKPj61RWIc7ms3oy5wLPmDdXNYVzrB1ywNxi
D/libpjsip( 2280): Max-Forwards: 70
D/libpjsip( 2280): From: &lt;sip:306@10.1.7.202&gt;;tag=C4xpCMKz46AQr6LV3Adlo9vZI8qZbkb0
D/libpjsip( 2280): To: &lt;sip:84957833444@10.1.7.202&gt;
D/libpjsip( 2280): Contact: &lt;sip:306@10.1.3.2:55079;ob&gt;
D/libpjsip( 2280): Call-ID: .rcsFthdp15m6fNBGMp6-dnKnhDtHV68
D/libpjsip( 2280): CSeq: 29000 INVITE
D/libpjsip( 2280): Route: &lt;sip:10.1.7.202;transport=udp;lr&gt;
D/libpjsip( 2280): Allow: PRACK, INVITE, ACK, BYE, CANCEL, UPDATE, INFO, SUBSCRIBE, NOTIFY, REFER, MESSAGE, OPTIONS
D/libpjsip( 2280): Supported: replaces, 100rel, timer, norefersub
D/libpjsip( 2280): Session-Expires: 1800
D/libpjsip( 2280): Min-SE: 90
D/libpjsip( 2280): User-Agent: CSipSimple_yecon77_mg789_tb_ics2-15/r2187
D/libpjsip( 2280): Content-Type: application/sdp
D/libpjsip( 2280): Content-Length:   364
D/libpjsip( 2280): 
D/libpjsip( 2280): v=0
D/libpjsip( 2280): o=- 3574327116 3574327116 IN IP4 192.168.5.33
D/libpjsip( 2280): s=pjmedia
D/libpjsip( 2280): c=IN IP4 192.168.5.33
D/libpjsip( 2280): t=0 0
D/libpjsip( 2280): m=audio 4002 RTP/AVP 8 9 0 3 106 101
D/libpjsip( 2280): c=IN IP4 192.168.5.33
D/libpjsip( 2280): a=rtcp:4003 IN IP4 192.168.5.33
D/libpjsip( 2280): a=sendrecv
D/libpjsip( 2280): a=rtpmap:8 PCMA/8000
D/libpjsip( 2280): a=rtpmap:9 G722/8000
D/libpjsip( 2280): a=rtpmap:0 PCMU/8000
D/libpjsip( 2280): a=rtpmap:3 GSM/8000
D/libpjsip( 2280): a=rtpmap:106 speex/16000
D/libpjsip( 2280): a=rtpmap:101 telephone-event/8000
D/libpjsip( 2280): a=fmtp:101 0-15
D/libpjsip( 2280): --end msg--
D/PowerManagerService(  246): releaseWakeLock flags=0x1 tag=SipWakeLock total_time=15ms
D/IPCThreadState(  246): [DN #5] BR_CLEAR_DEATH_NOTIFICATION_DONE cookie 0x11fe5a8
V/AlarmManager(  246): Checking for alarms... rtc=1365338348621, elapsed=1521856
V/AlarmManager(  246): Checking active alarm when=1521855 Alarm{42068ad0 type 2 com.csipsimple}
V/AlarmManager(  246): Alarm triggering: Alarm{42068ad0 type 2 com.csipsimple}
V/AlarmManager(  246): Checking active alarm when=1524698 Alarm{41f87808 type 2 com.csipsimple}
V/AlarmManager(  246): Native set alarm :Alarm{41f87808 type 2 com.csipsimple}
I/AlarmManager(  246): bootpackage = com.android.settings set Prop 2
I/AlarmManager(  246): rest power off alarm is com.android.settings
D/Provider/Setting(  246): NameValueTable putString power_off_alarm_package_name in content://settings/system value com.android.settings
D/Settings/Provide(  246): isRedundantSetValue, oldValuecom.android.settingsvaluecom.android.settings
D/Settings/Provide(  246): SettingsCache.isRedundantSetValue power_off_alarm_package_name com.android.settings
V/AlarmManager(  246): sending alarm Alarm{42068ad0 type 2 com.csipsimple}
V/ActivityManager(  246): Broadcast: Intent { act=com.csipsimple.PJ_TIMER dat=timer://256 flg=0x14 (has extras) } ordered=true
D/ActivityThread( 2280): BDC-Calling onReceive: intent=Intent { act=com.csipsimple.PJ_TIMER dat=timer://256 flg=0x14 (has extras) }, ordered=true, receiver=com.csipsimple.utils.TimerWrapper@414960c0, IIntentReceiver=41470740
D/PowerManagerService(  246): acquireWakeLock flags=0x1 tag=SipWakeLock
D/ActivityThread( 2280): BDC-Calling finishReceiver: IIntentReceiver=41470740
D/PowerManagerService(  246): acquireWakeLock flags=0x1 tag=AlarmManager
D/PowerManagerService(  246): releaseWakeLock flags=0x1 tag=AlarmManager total_time=0ms
I/libpjsip( 2280): 16:39:08.655 pjsua_jni_addo  ....Call 1 is DISCONNECTED [reason=408 (Request Timeout)]
D/SIP UA Receiver( 2280): &lt; LOCK CPU
D/PowerManagerService(  246): acquireWakeLock flags=0x1 tag=com.csipsimple.inEventLock
D/SIP UA Receiver( 2280): Call state &lt;&lt;
D/SIP UA Receiver( 2280): Updating call infos from the stack
D/PjSipCalls( 2280): Update call 1
D/PjService( 2280): Found pjsua 2 searching 2
D/IPCThreadState(  246): [DN #5] BR_CLEAR_DEATH_NOTIFICATION_DONE cookie 0xeac738
D/PjSipCalls( 2280): Last status code is 408
D/libpjsip( 2280): 16:39:08.659 zrtp_android.c  ....jzrtp_getInfoFromContext : user data 0      </p></markdown-widget>
              </span><!-- end ngIf: comment.content -->
              <!-- ngIf: !comment.content -->

              <!-- ngIf: comment.attachments.length -->
              <!-- ngRepeat: attachment in comment.attachments -->
            </div><!-- end ngRepeat: comment in issueCtrl.issue.comments --><div ng-repeat="comment in issueCtrl.issue.comments" class="ng-scope">
              <div>
                <!-- ngIf: comment.id --><h3 ng-if="comment.id" class="ng-binding ng-scope">Comment #1</h3><!-- end ngIf: comment.id -->
                <!-- ms to seconds. -->
                <small class="ng-binding">
                  Posted on May 23, 2013 by
                  <i class="ng-binding">Massive Rhino</i>
                </small>
              </div>

              <!-- TODO(chrsmith): Get the formatting right. Google Code comments
              are not stored in wiki/markdown or HTML format. So we probably need to
              create a custom filter to get 100% paritiy. -->
              <!-- ngIf: comment.content --><span ng-if="comment.content" class="ng-scope">
                <markdown-widget text="comment.content" class="markdown"><p>I have the same problem. While on VPN the media IP used in SDP is the interface IP not the VPN IP. Anyway to use the VPN assigned IP address instead of the phone's WiFi or 3G address?</p>

<p>Thanks!</p></markdown-widget>
              </span><!-- end ngIf: comment.content -->
              <!-- ngIf: !comment.content -->

              <!-- ngIf: comment.attachments.length -->
              <!-- ngRepeat: attachment in comment.attachments -->
            </div><!-- end ngRepeat: comment in issueCtrl.issue.comments --><div ng-repeat="comment in issueCtrl.issue.comments" class="ng-scope">
              <div>
                <!-- ngIf: comment.id --><h3 ng-if="comment.id" class="ng-binding ng-scope">Comment #2</h3><!-- end ngIf: comment.id -->
                <!-- ms to seconds. -->
                <small class="ng-binding">
                  Posted on Jun 29, 2013 by
                  <i class="ng-binding">Grumpy Camel</i>
                </small>
              </div>

              <!-- TODO(chrsmith): Get the formatting right. Google Code comments
              are not stored in wiki/markdown or HTML format. So we probably need to
              create a custom filter to get 100% paritiy. -->
              <!-- ngIf: comment.content --><span ng-if="comment.content" class="ng-scope">
                <markdown-widget text="comment.content" class="markdown"><p>Having the same issue. Any way to fix it?</p></markdown-widget>
              </span><!-- end ngIf: comment.content -->
              <!-- ngIf: !comment.content -->

              <!-- ngIf: comment.attachments.length -->
              <!-- ngRepeat: attachment in comment.attachments -->
            </div><!-- end ngRepeat: comment in issueCtrl.issue.comments --><div ng-repeat="comment in issueCtrl.issue.comments" class="ng-scope">
              <div>
                <!-- ngIf: comment.id --><h3 ng-if="comment.id" class="ng-binding ng-scope">Comment #3</h3><!-- end ngIf: comment.id -->
                <!-- ms to seconds. -->
                <small class="ng-binding">
                  Posted on Jun 29, 2013 by
                  <i class="ng-binding">Quick Hippo</i>
                </small>
              </div>

              <!-- TODO(chrsmith): Get the formatting right. Google Code comments
              are not stored in wiki/markdown or HTML format. So we probably need to
              create a custom filter to get 100% paritiy. -->
              <!-- ngIf: comment.content --><span ng-if="comment.content" class="ng-scope">
                <markdown-widget text="comment.content" class="markdown"><p>Please read my comment on issue 2375.
This is not a bug. The SIP control plane and the media plane are not necessarily using the same interface/route in SIP. Some network topologies could require what's done by pjsip currently. 
The only correct safe and reliable solution for multihomed is to use ICE and to have all parts supporting ICE. Or have a stun server on your sip server reachable from everywhere your client can connect.
(ICE basically gives candidates IP:port that remote can try to reach you).</p>

<p>Assuming you should be reached by the same interface than the VPN only because the sip server is also reachable using this interface is an assumption you do based on your topology. It's defined nowhere in SIP RFC that it should go this way and there is valid SIP topology where it should not go this way.</p>

<p>Read my comment on issue 2375 : there is something that you might find interesting too at the end that will allow to workaround this case : pjsip guys introduced an option to select the same ip than sip control plan in case you are in your topology case. However, you have to keep in mind it will be a workaround and that your topology is not stable without usage of ICE. (I mean other sip clients could reach same problems because they have no clue on your topology).</p></markdown-widget>
              </span><!-- end ngIf: comment.content -->
              <!-- ngIf: !comment.content -->

              <!-- ngIf: comment.attachments.length -->
              <!-- ngRepeat: attachment in comment.attachments -->
            </div><!-- end ngRepeat: comment in issueCtrl.issue.comments -->
          </div>

          <!-- Sidebar with additional information -->
          <div class="maia-col-4">
            <div class="maia-aside">
              <p>Status: <code class="ng-binding">Duplicate</code></p>
              <!-- ngIf: issueCtrl.issue.labels.length > 0 --><p ng-if="issueCtrl.issue.labels.length &gt; 0" class="ng-scope">
                Labels:
                <br>
                <!-- ngRepeat: label in issueCtrl.issue.labels track by $index --><span ng-repeat="label in issueCtrl.issue.labels track by $index" class="ng-scope">
                  <span class="gca-label ng-binding">Type-Defect</span>
                </span><!-- end ngRepeat: label in issueCtrl.issue.labels track by $index --><span ng-repeat="label in issueCtrl.issue.labels track by $index" class="ng-scope">
                  <span class="gca-label ng-binding">Priority-Medium</span>
                </span><!-- end ngRepeat: label in issueCtrl.issue.labels track by $index -->
              </p><!-- end ngIf: issueCtrl.issue.labels.length > 0 -->
            </div>
          </div>
        </div><!-- end ngIf: !issueCtrl.error -->
      </div>
    </div>

  </div>
</div>
</div></div></div>
    <noscript>
      &lt;p&gt;The Google Code Archive requires JavaScript to be enabled in your browser.&lt;/p&gt;
    </noscript>

    <div id="maia-signature"></div>
    <div class="maia-footer" id="maia-footer">
      <div id="maia-footer-local">
      </div>
      <div id="maia-footer-global">
        <div class="maia-aux">
          <ul>
            <li>
              <a href="//www.google.com/">Google</a>
            </li>
            <li>
              <a href="//www.google.com/intl/en/about/">About Google</a>
            </li>
            <li>
              <a href="//www.google.com/intl/en/policies/privacy/">Privacy</a>
            </li>
            <li>
              <a href="//www.google.com/intl/en/policies/terms/">Terms</a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <script src="//www.google.com/js/maia.js"></script>
  


</body></html>