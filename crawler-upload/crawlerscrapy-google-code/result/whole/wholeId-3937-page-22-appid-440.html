https://code.google.com/archive/p/csipsimple/issues/899<!DOCTYPE html><html class="google ng-scope" lang="en" ng-app="codesiteArchive.application"><head>
    <meta charset="utf-8">
    <meta content="initial-scale=1, minimum-scale=1, width=device-width" name="viewport">

    <!-- https://developers.google.com/webmasters/ajax-crawling/docs/specification -->
    <meta name="fragment" content="!">
    <title>Google Code Archive - Long-term storage for Google Code Project Hosting.</title>

    <link rel="icon" type="image/vnd.microsoft.icon" href="/archive/img/project-hosting.ico">
    <script src="//www.google.com/js/google.js"></script>
    <link href="//www.google.com/css/maia.css" rel="stylesheet">
    <link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,600,700&amp;lang=en" rel="stylesheet">
    <link rel="stylesheet" href="/archive/archive_css.css">
    <script>
      CLOSURE_NO_DEPS = true;
    </script>
    <script src="/archive/angular.js"></script><style type="text/css">@charset "UTF-8";

[ng\:cloak], [ng-cloak], [data-ng-cloak], [x-ng-cloak],
.ng-cloak, .x-ng-cloak,
.ng-hide:not(.ng-hide-animate) {
  display: none !important;
}

ng\:form {
  display: block;
}

.ng-animate-shim {
  visibility:hidden;
}

.ng-anchor {
  position:absolute;
}
</style>
    <script src="/archive/pagedown.js"></script>
    <script src="/archive/archive.js"></script>
    <base href="/archive/">
  </head>

  <body>
    <div class="maia-header" id="maia-header" role="banner">
      <div class="maia-aux">
        <a href="/archive/">
          </a><h1><a href="/archive/">
            <img alt="Google" src="//www.google.com/images/branding/googlelogo/1x/googlelogo_color_116x41dp.png"> Code</a>
          </h1>
        
        <a href="/archive/">
          <h2>Archive</h2>
        </a>
        <a class="maia-teleport" href="#content">Skip to content</a>
        <div class="maia-util">
          <form action="/archive/search" class="maia-search ng-pristine ng-valid">
            <input name="q" placeholder="Search this site" type="text">
            <button class="maia-button">
              <span class="maia-search-icon">Search</span>
            </button>
          </form>
        </div>
      </div>
    </div>

    <!-- ngView: --><div ng-view="" class="ng-scope"><div ng-controller="ProjectIssueCtrl as issueCtrl" class="ng-scope">
<nav-bar-widget nav-level-1="projectCtrl.navLevel1" class="ng-isolate-scope"><div class="maia-nav maia-complex" id="maia-nav-x" role="navigation">
  <div class="maia-aux">
    <ul>
      <li ng-class="{active: navLevel1 == 'projects'}">
        <a href="/archive/">Projects</a>
        <!-- ngIf: navLevel2 -->
      </li>
      <li ng-class="{active: navLevel1 == 'search'}">
        <a href="/archive/search">Search</a>
      </li>
      <li ng-class="{active: navLevel1 == 'about'}">
        <a href="/archive/about">About</a>
      </li>
    </ul>
  </div>
</div>
</nav-bar-widget>
<div id="maia-main" role="main">

  <!-- ngIf: issueCtrl.notFound -->

  <div ng-hide="issueCtrl.notFound">
    <!-- Left-side resource nav -->
    <project-resources-widget domain="issueCtrl.domain" project="issueCtrl.projectName" class="ng-isolate-scope"><div class="maia-nav" id="maia-nav-y" role="navigation">
  <!-- ngIf: domain == 'code.google.com' --><ul ng-if="domain == 'code.google.com'" class="ng-scope">
    <li class="active">
      <a href="/archive/p/csipsimple/">Project</a>
    </li>
    <li>
      <a href="/archive/p/csipsimple/source">Source</a>
    </li>
    <li>
      <a href="/archive/p/csipsimple/issues">Issues</a>
    </li>
    <li>
      <a href="/archive/p/csipsimple/wikis">Wikis</a>
    </li>
    <li>
      <a href="/archive/p/csipsimple/downloads">Downloads</a>
    </li>
  </ul><!-- end ngIf: domain == 'code.google.com' -->

    <!-- ngIf: domain != 'code.google.com' -->
</div></project-resources-widget>

    <div class="maia-article" role="article">
      <div class="maia-teleport" id="content"></div>
      <div class="maia-cols">
        <div id="gca-project-header" class="maia-col-10">
          <a id="gca-export-to-gh" class="maia-button" href="https://code.google.com/export-to-github/export?project=csipsimple">Export to GitHub</a>
            <img class="gca-project-logo" src="https://storage.googleapis.com/google-code-archive/v2/code.google.com/csipsimple/logo.png">
            <h1 class="ng-binding">csipsimple - issue #899</h1>
            <p class="ng-binding">Add app to the menu of apps</p>
        </div>

        <div class="maia-col-10">
          <hr>

        <!-- ngIf: issueCtrl.error -->

        <!-- ngIf: !issueCtrl.error --><div ng-if="!issueCtrl.error" class="ng-scope">
          <!-- Comments -->
          <div class="maia-col-8">
            <!-- ngRepeat: comment in issueCtrl.issue.comments --><div ng-repeat="comment in issueCtrl.issue.comments" class="ng-scope">
              <div>
                <!-- ngIf: comment.id -->
                <!-- ms to seconds. -->
                <small class="ng-binding">
                  Posted on Apr 20, 2011 by
                  <i class="ng-binding">Helpful Bird</i>
                </small>
              </div>

              <!-- TODO(chrsmith): Get the formatting right. Google Code comments
              are not stored in wiki/markdown or HTML format. So we probably need to
              create a custom filter to get 100% paritiy. -->
              <!-- ngIf: comment.content --><span ng-if="comment.content" class="ng-scope">
                <markdown-widget text="comment.content" class="markdown"><p>Hello,</p>

<p>Your menu is diff√©rent that other SIP app, it intercepts the call action after call option, not before. I use the normal call, SIP call and Callback. I've multiple menus that are displayed one after another just to call somebody if I want to useyour app for SIP call and InternetCall for Callback.</p>

<p>To use your app and Callback app, I click on contact, clic on call, click on app, etc. It's a lot of clicks for call to somebody. I chose your app as default call app because in it's own menu, it propose to use normal call, skypeout, InternetCall Callback etc.</p>

<p>But when I click on InternetCall Callback, it doesn't transfert the action to Callback app, your app shows me this message "This application is not yet supported (com.ggp.internetcall)..."</p>

<p>It's strange that the app is listed but can't be use without you add it to your app. It would be more flexible if the menu of your app was only transmit the action, it's an idea. But in the first time, can you authorize the callback app in your menu ?</p>

<p>Thank you,</p>

<p>Brogniaux G.</p></markdown-widget>
              </span><!-- end ngIf: comment.content -->
              <!-- ngIf: !comment.content -->

              <!-- ngIf: comment.attachments.length -->
              <!-- ngRepeat: attachment in comment.attachments -->
            </div><!-- end ngRepeat: comment in issueCtrl.issue.comments --><div ng-repeat="comment in issueCtrl.issue.comments" class="ng-scope">
              <div>
                <!-- ngIf: comment.id --><h3 ng-if="comment.id" class="ng-binding ng-scope">Comment #1</h3><!-- end ngIf: comment.id -->
                <!-- ms to seconds. -->
                <small class="ng-binding">
                  Posted on Apr 20, 2011 by
                  <i class="ng-binding">Quick Hippo</i>
                </small>
              </div>

              <!-- TODO(chrsmith): Get the formatting right. Google Code comments
              are not stored in wiki/markdown or HTML format. So we probably need to
              create a custom filter to get 100% paritiy. -->
              <!-- ngIf: comment.content --><span ng-if="comment.content" class="ng-scope">
                <markdown-widget text="comment.content" class="markdown"><p>Hi,</p>

<p>Yeah indeed, the way csipsimple integrate the call action is slightly different. It allow to rewrite the call entry and make the integration more flawless for users and also allow to create filters regardless of the app that will be finally choosen.</p>

<p>In fact I detect apps that registers the priviledge call intent. This intent can be listed but not launched (it would required priviledges that can't be granted to an app on the android market). 
As consequence I have to implement a custom "open" intent for each third party application. </p>

<p>Here is the implementation that exists for now :
<a href="http://code.google.com/p/csipsimple/source/browse/trunk/CSipSimple/src/com/csipsimple/ui/OutgoingCallChooser.java#291">http://code.google.com/p/csipsimple/source/browse/trunk/CSipSimple/src/com/csipsimple/ui/OutgoingCallChooser.java#291</a>
It's done for the telephony app using a tel intent, for the skype app that I reverse engineered with their skype protocol.</p>

<p>If you give me what intent I should raise for this app (actually the UI compenent that register the tel: intent if any), I'd be pleased to add it to the list of supported apps :)</p></markdown-widget>
              </span><!-- end ngIf: comment.content -->
              <!-- ngIf: !comment.content -->

              <!-- ngIf: comment.attachments.length -->
              <!-- ngRepeat: attachment in comment.attachments -->
            </div><!-- end ngRepeat: comment in issueCtrl.issue.comments --><div ng-repeat="comment in issueCtrl.issue.comments" class="ng-scope">
              <div>
                <!-- ngIf: comment.id --><h3 ng-if="comment.id" class="ng-binding ng-scope">Comment #2</h3><!-- end ngIf: comment.id -->
                <!-- ms to seconds. -->
                <small class="ng-binding">
                  Posted on Apr 20, 2011 by
                  <i class="ng-binding">Helpful Bird</i>
                </small>
              </div>

              <!-- TODO(chrsmith): Get the formatting right. Google Code comments
              are not stored in wiki/markdown or HTML format. So we probably need to
              create a custom filter to get 100% paritiy. -->
              <!-- ngIf: comment.content --><span ng-if="comment.content" class="ng-scope">
                <markdown-widget text="comment.content" class="markdown"><p>I'm not the owner of the app, I've limited knowlege in Java and nothing in Android API ^^ but the InternetCall project is open sources :)</p>

<p>Here the link : <a href="http://code.google.com/p/internet-call/">http://code.google.com/p/internet-call/</a></p>

<p>I can forward your message to the owner of InternetCall if the link don't help you.</p>

<p>Thanks,
Brogniaux G.</p></markdown-widget>
              </span><!-- end ngIf: comment.content -->
              <!-- ngIf: !comment.content -->

              <!-- ngIf: comment.attachments.length -->
              <!-- ngRepeat: attachment in comment.attachments -->
            </div><!-- end ngRepeat: comment in issueCtrl.issue.comments --><div ng-repeat="comment in issueCtrl.issue.comments" class="ng-scope">
              <div>
                <!-- ngIf: comment.id --><h3 ng-if="comment.id" class="ng-binding ng-scope">Comment #3</h3><!-- end ngIf: comment.id -->
                <!-- ms to seconds. -->
                <small class="ng-binding">
                  Posted on Apr 20, 2011 by
                  <i class="ng-binding">Quick Hippo</i>
                </small>
              </div>

              <!-- TODO(chrsmith): Get the formatting right. Google Code comments
              are not stored in wiki/markdown or HTML format. So we probably need to
              create a custom filter to get 100% paritiy. -->
              <!-- ngIf: comment.content --><span ng-if="comment.content" class="ng-scope">
                <markdown-widget text="comment.content" class="markdown"><p>Ok,</p>

<p>Regarding code, there is missing intent filters so that I can call it externally without making a call_priviledged intent.</p>

<p>I'm thinking about something else, there is an openpoint about this exact feature provided by internet-call project in csipsimple.
If owner of InternetCall wants to contribute csipsimple it will be welcome :). CSipSimple already has some powerful rewriting and filtering rules engine that internet call could take advantage of directly. I see in the source code some hardcoded rewriting rules, but could be interesting to direclty use csipsimple rewriting engine to create the same rules. The missing points in csipsimple (which are requested by sip providers and users), are to allow multiple entries for GSM choice (so that we can have tel:SIPPROVIDERGATEWAY,,DEST -- the rewrting can be done with rewriting rules already), and to allow another output for http:xxxxxxxx$DESTxxxxx which could theoretically be also done using a rewriting rules and an extra entry in the outgoing call chooser.</p>

<p>Having things integrated in the csipsimple engine will be more interesting cause it can also provide feature such as automatically choose which is the right choice to do for some rules -- for example :  &lt;&gt;</p></markdown-widget>
              </span><!-- end ngIf: comment.content -->
              <!-- ngIf: !comment.content -->

              <!-- ngIf: comment.attachments.length -->
              <!-- ngRepeat: attachment in comment.attachments -->
            </div><!-- end ngRepeat: comment in issueCtrl.issue.comments --><div ng-repeat="comment in issueCtrl.issue.comments" class="ng-scope">
              <div>
                <!-- ngIf: comment.id --><h3 ng-if="comment.id" class="ng-binding ng-scope">Comment #4</h3><!-- end ngIf: comment.id -->
                <!-- ms to seconds. -->
                <small class="ng-binding">
                  Posted on Apr 21, 2011 by
                  <i class="ng-binding">Helpful Bird</i>
                </small>
              </div>

              <!-- TODO(chrsmith): Get the formatting right. Google Code comments
              are not stored in wiki/markdown or HTML format. So we probably need to
              create a custom filter to get 100% paritiy. -->
              <!-- ngIf: comment.content --><span ng-if="comment.content" class="ng-scope">
                <markdown-widget text="comment.content" class="markdown"><p>I send him the email for the missing function and your rewriting and filtering rules engine (but he's very busy at this moment)</p>

<p>Thank you for your time and your work :-)</p>

<p>Best regards,
Brogniaux G.</p></markdown-widget>
              </span><!-- end ngIf: comment.content -->
              <!-- ngIf: !comment.content -->

              <!-- ngIf: comment.attachments.length -->
              <!-- ngRepeat: attachment in comment.attachments -->
            </div><!-- end ngRepeat: comment in issueCtrl.issue.comments --><div ng-repeat="comment in issueCtrl.issue.comments" class="ng-scope">
              <div>
                <!-- ngIf: comment.id --><h3 ng-if="comment.id" class="ng-binding ng-scope">Comment #5</h3><!-- end ngIf: comment.id -->
                <!-- ms to seconds. -->
                <small class="ng-binding">
                  Posted on Apr 23, 2011 by
                  <i class="ng-binding">Helpful Bird</i>
                </small>
              </div>

              <!-- TODO(chrsmith): Get the formatting right. Google Code comments
              are not stored in wiki/markdown or HTML format. So we probably need to
              create a custom filter to get 100% paritiy. -->
              <!-- ngIf: comment.content --><span ng-if="comment.content" class="ng-scope">
                <markdown-widget text="comment.content" class="markdown"><p>Hello,</p>

<p>Sorry for the delay, I talked to him. It's something like this that you have to have ? I don't really know why you can't use InternetCall externally.</p>

<p>Intent intent = new Intent();
        intent.setComponent(new ComponentName("com.ggp.internetcall", "com.ggp.internetcall.CallbackCallingActivity"));
        intent.setData(Uri.fromParts("tel", "003312345678", null));
        startActivity(intent);</p>

<p>Best regards,
Brogniaux G.</p></markdown-widget>
              </span><!-- end ngIf: comment.content -->
              <!-- ngIf: !comment.content -->

              <!-- ngIf: comment.attachments.length -->
              <!-- ngRepeat: attachment in comment.attachments -->
            </div><!-- end ngRepeat: comment in issueCtrl.issue.comments --><div ng-repeat="comment in issueCtrl.issue.comments" class="ng-scope">
              <div>
                <!-- ngIf: comment.id --><h3 ng-if="comment.id" class="ng-binding ng-scope">Comment #6</h3><!-- end ngIf: comment.id -->
                <!-- ms to seconds. -->
                <small class="ng-binding">
                  Posted on Apr 23, 2011 by
                  <i class="ng-binding">Quick Hippo</i>
                </small>
              </div>

              <!-- TODO(chrsmith): Get the formatting right. Google Code comments
              are not stored in wiki/markdown or HTML format. So we probably need to
              create a custom filter to get 100% paritiy. -->
              <!-- ngIf: comment.content --><span ng-if="comment.content" class="ng-scope">
                <markdown-widget text="comment.content" class="markdown"><p>I'm not sure, but I think that this will fail.</p>

<p>Process of make call is more complicated than just a simple intent. There is many security layers between.</p>

<p>Look, <a href="http://code.google.com/p/internet-call/source/browse/trunk/AndroidManifest.xml">http://code.google.com/p/internet-call/source/browse/trunk/AndroidManifest.xml</a></p>

<p>In the manifest, the registration is done on the intent action "android.intent.action.CALL_PRIVILEGED".</p>

<p>In your example you do not specify an action but obviously we have to setup one.</p>

<p>You'll say, ok, just add the action "android.intent.action.CALL_PRIVILEGED"... problem is that it's not authorized to an application that is not signed as an android system application ! (which can be performed only if the app is shipped with the ROM).</p>

<p>So internet-call app will never receive my intent. (that was my point in ¬ß2 of my first comment). I can see how register this intent but I can't launch this intent cause I've not rights to do so !</p>

<p>As consequence a solution is to add a new intent filter in the internet-call app to allow third party apps to call an intent on it.
Besides I'd advise to make things secure on internet-call side so that apps that are not allowed to make internet-calls intent do not. I'd advise to use either the permission "android.permission.CALL_PHONE" or "android.permission.USE_SIP" (in this case, do like I do in my manifest, redefine this permission to ensure compatibility on all android versions). Then when receiving the intent just check permission is granted.</p>

<p>This was not required while using the "android.intent.action.CALL_PRIVILEGED" that can be raised only by an app that own "android.permission.CALL_PRIVILEGED" permission that already treat intents of type "android.intent.action.CALL" and check privilege "android.permission.CALL_PHONE".</p>

<p>So the important point is that, it's not direct and that action registered by internet-call app can not be performed by other app than privileged apps (rom apps).
I read a lot the android phone application and that's what I understood from this reading. Correct if I mistake but I think this is correct - I also did tests to check if any workaround would be possible to avoid to add each app manually, but unfortunately my conclusion was that I had to use an open door defined by each app that choose to register like that.</p>

<p>It make absolutely sense if you think in terms of security. Phone calls is something really critical in terms of security. 
I would add that I think that registering CALL_PRIVILEGED is a very bad way to do... well it's good for me cause it allow me to detect other apps and it does not use the same channel than mine ;) ... but ...
 * It's not documented in the SDK
 * And this intent should also be used to manage emergency numbers and an app should <em>never</em> interfere with that.
 * Last point, in terms of user experience that's not really cool... you may ask at very least once (most users does not understand this popup), for choosing between dialer and your app -- and this without any conditions (reach-ability of your service, user settings inside the app). </p>

<p>The way things are done in CSipSimple is, documented in SDK ( <a href="http://developer.android.com/reference/android/content/Intent.html#ACTION_NEW_OUTGOING_CALL">http://developer.android.com/reference/android/content/Intent.html#ACTION_NEW_OUTGOING_CALL</a> ), will not interfer with emergency numbers (unless manufacturer of the phone do crappy things), and will not show anything to the user and can rewrite silently, and finally use a correct and clear permission (PROCESS_OUTGOING_CALL). That's much more tricky to implement however.</p></markdown-widget>
              </span><!-- end ngIf: comment.content -->
              <!-- ngIf: !comment.content -->

              <!-- ngIf: comment.attachments.length -->
              <!-- ngRepeat: attachment in comment.attachments -->
            </div><!-- end ngRepeat: comment in issueCtrl.issue.comments --><div ng-repeat="comment in issueCtrl.issue.comments" class="ng-scope">
              <div>
                <!-- ngIf: comment.id --><h3 ng-if="comment.id" class="ng-binding ng-scope">Comment #7</h3><!-- end ngIf: comment.id -->
                <!-- ms to seconds. -->
                <small class="ng-binding">
                  Posted on Jul 3, 2011 by
                  <i class="ng-binding">Quick Hippo</i>
                </small>
              </div>

              <!-- TODO(chrsmith): Get the formatting right. Google Code comments
              are not stored in wiki/markdown or HTML format. So we probably need to
              create a custom filter to get 100% paritiy. -->
              <!-- ngIf: comment.content --><span ng-if="comment.content" class="ng-scope">
                <markdown-widget text="comment.content" class="markdown"><p>My last comment on issue 110 explains why this issue is obsolete. </p>

<p>I release a plugin for CSipSimple that cover same features than internet-call but that integrated cleanly to csipsimple and also take advantage of csipsimple.</p></markdown-widget>
              </span><!-- end ngIf: comment.content -->
              <!-- ngIf: !comment.content -->

              <!-- ngIf: comment.attachments.length -->
              <!-- ngRepeat: attachment in comment.attachments -->
            </div><!-- end ngRepeat: comment in issueCtrl.issue.comments -->
          </div>

          <!-- Sidebar with additional information -->
          <div class="maia-col-4">
            <div class="maia-aside">
              <p>Status: <code class="ng-binding">Duplicate</code></p>
              <!-- ngIf: issueCtrl.issue.labels.length > 0 --><p ng-if="issueCtrl.issue.labels.length &gt; 0" class="ng-scope">
                Labels:
                <br>
                <!-- ngRepeat: label in issueCtrl.issue.labels track by $index --><span ng-repeat="label in issueCtrl.issue.labels track by $index" class="ng-scope">
                  <span class="gca-label ng-binding">Type-Enhancement</span>
                </span><!-- end ngRepeat: label in issueCtrl.issue.labels track by $index --><span ng-repeat="label in issueCtrl.issue.labels track by $index" class="ng-scope">
                  <span class="gca-label ng-binding">Priority-Low</span>
                </span><!-- end ngRepeat: label in issueCtrl.issue.labels track by $index -->
              </p><!-- end ngIf: issueCtrl.issue.labels.length > 0 -->
            </div>
          </div>
        </div><!-- end ngIf: !issueCtrl.error -->
      </div>
    </div>

  </div>
</div>
</div></div></div>
    <noscript>
      &lt;p&gt;The Google Code Archive requires JavaScript to be enabled in your browser.&lt;/p&gt;
    </noscript>

    <div id="maia-signature"></div>
    <div class="maia-footer" id="maia-footer">
      <div id="maia-footer-local">
      </div>
      <div id="maia-footer-global">
        <div class="maia-aux">
          <ul>
            <li>
              <a href="//www.google.com/">Google</a>
            </li>
            <li>
              <a href="//www.google.com/intl/en/about/">About Google</a>
            </li>
            <li>
              <a href="//www.google.com/intl/en/policies/privacy/">Privacy</a>
            </li>
            <li>
              <a href="//www.google.com/intl/en/policies/terms/">Terms</a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <script src="//www.google.com/js/maia.js"></script>
  


</body></html>