https://code.google.com/archive/p/csipsimple/issues/2086<!DOCTYPE html><html class="google ng-scope" lang="en" ng-app="codesiteArchive.application"><head>
    <meta charset="utf-8">
    <meta content="initial-scale=1, minimum-scale=1, width=device-width" name="viewport">

    <!-- https://developers.google.com/webmasters/ajax-crawling/docs/specification -->
    <meta name="fragment" content="!">
    <title>Google Code Archive - Long-term storage for Google Code Project Hosting.</title>

    <link rel="icon" type="image/vnd.microsoft.icon" href="/archive/img/project-hosting.ico">
    <script src="//www.google.com/js/google.js"></script>
    <link href="//www.google.com/css/maia.css" rel="stylesheet">
    <link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,600,700&amp;lang=en" rel="stylesheet">
    <link rel="stylesheet" href="/archive/archive_css.css">
    <script>
      CLOSURE_NO_DEPS = true;
    </script>
    <script src="/archive/angular.js"></script><style type="text/css">@charset "UTF-8";

[ng\:cloak], [ng-cloak], [data-ng-cloak], [x-ng-cloak],
.ng-cloak, .x-ng-cloak,
.ng-hide:not(.ng-hide-animate) {
  display: none !important;
}

ng\:form {
  display: block;
}

.ng-animate-shim {
  visibility:hidden;
}

.ng-anchor {
  position:absolute;
}
</style>
    <script src="/archive/pagedown.js"></script>
    <script src="/archive/archive.js"></script>
    <base href="/archive/">
  </head>

  <body>
    <div class="maia-header" id="maia-header" role="banner">
      <div class="maia-aux">
        <a href="/archive/">
          </a><h1><a href="/archive/">
            <img alt="Google" src="//www.google.com/images/branding/googlelogo/1x/googlelogo_color_116x41dp.png"> Code</a>
          </h1>
        
        <a href="/archive/">
          <h2>Archive</h2>
        </a>
        <a class="maia-teleport" href="#content">Skip to content</a>
        <div class="maia-util">
          <form action="/archive/search" class="maia-search ng-pristine ng-valid">
            <input name="q" placeholder="Search this site" type="text">
            <button class="maia-button">
              <span class="maia-search-icon">Search</span>
            </button>
          </form>
        </div>
      </div>
    </div>

    <!-- ngView: --><div ng-view="" class="ng-scope"><div ng-controller="ProjectIssueCtrl as issueCtrl" class="ng-scope">
<nav-bar-widget nav-level-1="projectCtrl.navLevel1" class="ng-isolate-scope"><div class="maia-nav maia-complex" id="maia-nav-x" role="navigation">
  <div class="maia-aux">
    <ul>
      <li ng-class="{active: navLevel1 == 'projects'}">
        <a href="/archive/">Projects</a>
        <!-- ngIf: navLevel2 -->
      </li>
      <li ng-class="{active: navLevel1 == 'search'}">
        <a href="/archive/search">Search</a>
      </li>
      <li ng-class="{active: navLevel1 == 'about'}">
        <a href="/archive/about">About</a>
      </li>
    </ul>
  </div>
</div>
</nav-bar-widget>
<div id="maia-main" role="main">

  <!-- ngIf: issueCtrl.notFound -->

  <div ng-hide="issueCtrl.notFound">
    <!-- Left-side resource nav -->
    <project-resources-widget domain="issueCtrl.domain" project="issueCtrl.projectName" class="ng-isolate-scope"><div class="maia-nav" id="maia-nav-y" role="navigation">
  <!-- ngIf: domain == 'code.google.com' --><ul ng-if="domain == 'code.google.com'" class="ng-scope">
    <li class="active">
      <a href="/archive/p/csipsimple/">Project</a>
    </li>
    <li>
      <a href="/archive/p/csipsimple/source">Source</a>
    </li>
    <li>
      <a href="/archive/p/csipsimple/issues">Issues</a>
    </li>
    <li>
      <a href="/archive/p/csipsimple/wikis">Wikis</a>
    </li>
    <li>
      <a href="/archive/p/csipsimple/downloads">Downloads</a>
    </li>
  </ul><!-- end ngIf: domain == 'code.google.com' -->

    <!-- ngIf: domain != 'code.google.com' -->
</div></project-resources-widget>

    <div class="maia-article" role="article">
      <div class="maia-teleport" id="content"></div>
      <div class="maia-cols">
        <div id="gca-project-header" class="maia-col-10">
          <a id="gca-export-to-gh" class="maia-button" href="https://code.google.com/export-to-github/export?project=csipsimple">Export to GitHub</a>
            <img class="gca-project-logo" src="https://storage.googleapis.com/google-code-archive/v2/code.google.com/csipsimple/logo.png">
            <h1 class="ng-binding">csipsimple - issue #2086</h1>
            <p class="ng-binding">OPUS Drops Frames</p>
        </div>

        <div class="maia-col-10">
          <hr>

        <!-- ngIf: issueCtrl.error -->

        <!-- ngIf: !issueCtrl.error --><div ng-if="!issueCtrl.error" class="ng-scope">
          <!-- Comments -->
          <div class="maia-col-8">
            <!-- ngRepeat: comment in issueCtrl.issue.comments --><div ng-repeat="comment in issueCtrl.issue.comments" class="ng-scope">
              <div>
                <!-- ngIf: comment.id -->
                <!-- ms to seconds. -->
                <small class="ng-binding">
                  Posted on Nov 24, 2012 by
                  <i class="ng-binding">Quick Horse</i>
                </small>
              </div>

              <!-- TODO(chrsmith): Get the formatting right. Google Code comments
              are not stored in wiki/markdown or HTML format. So we probably need to
              create a custom filter to get 100% paritiy. -->
              <!-- ngIf: comment.content --><span ng-if="comment.content" class="ng-scope">
                <markdown-widget text="comment.content" class="markdown"><p><b>What steps will reproduce the problem?</b>
1.Call using the OPUS codec</p>

<p><b>What is the expected output? What do you see instead?</b>
Clear audio is expected, semi-garbley audio is produced.</p>

<p><b>What version of the product are you using? On what operating system?</b>
Latest nightly with latest codec pack as well.  Cyanogenmod 7.1 on a nexus one.</p>

<p><b>Please provide any additional information below.</b></p>

<p>Here is a relevant log trace of the issue at hand:</p>

<p>D/libpjsip( 9126): Remote-Party-ID: "voicemail" &lt;sip:&gt;;party=calling;privacy=off;screen=no
D/libpjsip( 9126): 
D/libpjsip( 9126): v=0
D/libpjsip( 9126): o=FreeSWITCH 1353788404 1353788405 IN IP4 0.0.0.0
D/libpjsip( 9126): s=FreeSWITCH
D/libpjsip( 9126): c=IN IP4 0.0.0.0
D/libpjsip( 9126): t=0 0
D/libpjsip( 9126): m=audio 23590 RTP/AVP 111 101
D/libpjsip( 9126): a=rtpmap:111 opus/48000
D/libpjsip( 9126): a=rtpmap:101 telephone-event/8000
D/libpjsip( 9126): a=fmtp:101 0-16
D/libpjsip( 9126): a=silenceSupp:off - - - -
D/libpjsip( 9126): a=ptime:40
D/libpjsip( 9126): --end msg--
D/libpjsip( 9126): 20:53:13.986 timer_android.  ..Ask to cancel something already fired or cancelled : -1
I/libpjsip( 9126): 20:53:14.007 pjsua_jni_addo  .....Call 0 state changed to CONNECTING
D/SIP UA Receiver( 9126): &lt; LOCK CPU
D/SIP UA Receiver( 9126): Call state &lt;&lt;
D/SIP UA Receiver( 9126): Updating call infos from the stack
D/PjSipCalls( 9126): Update call 0
D/PjService( 9126): Found pjsua 2 searching 2
D/PjSipCalls( 9126): Last status code is 200
D/libpjsip( 9126): 20:53:14.020 zrtp_android.c  .....jzrtp_getInfoFromContext : user data 0
D/SIP UA Receiver( 9126): &lt; LOCK CPU
D/SIP UA Receiver( 9126): Call state &gt;&gt;
D/SIP UA Receiver( 9126): &gt; UNLOCK CPU 1
D/libpjsip( 9126): 20:53:14.027  pjsua_media.c  .....Call 0: updating media..
D/libpjsip( 9126): 20:53:14.027    pjsua_aud.c  ......Audio channel update..
D/libpjsip( 9126): 20:53:14.027      pj_opus.c  .......Clock rate is 48000 
D/libpjsip( 9126): 20:53:14.032   strm0x1a2ddc  .......Encoder stream started
D/libpjsip( 9126): 20:53:14.032   strm0x1a2ddc  .......Decoder stream started
D/libpjsip( 9126): 20:53:14.036  pjsua_media.c  ......Audio updated, stream #0: opus (sendrecv)
D/SIP UA Receiver( 9126): &lt; LOCK CPU
D/SIP UA Receiver( 9126): Updating call infos from the stack
D/PjSipCalls( 9126): Update call 0
D/Prefs   ( 9126): We are valid for WIFI
D/SIP UA Receiver( 9126): Ignore extra launch handler
D/SIP UA Receiver( 9126): &gt; UNLOCK CPU 1
D/PjService( 9126): Found pjsua 2 searching 2
D/libpjsip( 9126): 20:53:14.074 pjsua_jni_addo  .....Get secure for media type 1
D/libpjsip( 9126): 20:53:14.074 zrtp_android.c  .....jzrtp_getInfoFromContext : user data 0
D/libpjsip( 9126): 20:53:14.074    pjsua_aud.c  .....Conf connect: 2 --&gt; 0
D/libpjsip( 9126): 20:53:14.074   conference.c  ......Port 2 (sip:) transmitting to port 0 (OpenSL ES Audio)
D/libpjsip( 9126): 20:53:14.074    pjsua_aud.c  .....Conf connect: 0 --&gt; 2
D/libpjsip( 9126): 20:53:14.074   conference.c  ......Port 0 (OpenSL ES Audio) transmitting to port 2 (sip:)
D/libpjsip( 9126): 20:53:14.103   Master/sound !Underflow, buf_cnt=0, will generate 1 frame
D/Prefs   ( 9126): We are valid for WIFI
D/SIP SRV ( 9126): Start was asked and we should actually start now
D/SIP SRV ( 9126): Ask pjservice to start itself
D/SIP UA Receiver( 9126): &lt; LOCK CPU
D/SIP UA Receiver( 9126): &gt; UNLOCK CPU 1
D/SIP UA Receiver( 9126): &gt; UNLOCK CPU 0</p></markdown-widget>
              </span><!-- end ngIf: comment.content -->
              <!-- ngIf: !comment.content -->

              <!-- ngIf: comment.attachments.length -->
              <!-- ngRepeat: attachment in comment.attachments -->
            </div><!-- end ngRepeat: comment in issueCtrl.issue.comments --><div ng-repeat="comment in issueCtrl.issue.comments" class="ng-scope">
              <div>
                <!-- ngIf: comment.id --><h3 ng-if="comment.id" class="ng-binding ng-scope">Comment #1</h3><!-- end ngIf: comment.id -->
                <!-- ms to seconds. -->
                <small class="ng-binding">
                  Posted on Nov 25, 2012 by
                  <i class="ng-binding">Quick Hippo</i>
                </small>
              </div>

              <!-- TODO(chrsmith): Get the formatting right. Google Code comments
              are not stored in wiki/markdown or HTML format. So we probably need to
              create a custom filter to get 100% paritiy. -->
              <!-- ngIf: comment.content --><span ng-if="comment.content" class="ng-scope">
                <markdown-widget text="comment.content" class="markdown"><p>hi,
is your freeswitch up to date ?
And is remote side supports opus as well?
some previous version of freeswitch has bug with opus timestamps and it could be your problem. They have fixed it in a recent jira item.</p></markdown-widget>
              </span><!-- end ngIf: comment.content -->
              <!-- ngIf: !comment.content -->

              <!-- ngIf: comment.attachments.length -->
              <!-- ngRepeat: attachment in comment.attachments -->
            </div><!-- end ngRepeat: comment in issueCtrl.issue.comments --><div ng-repeat="comment in issueCtrl.issue.comments" class="ng-scope">
              <div>
                <!-- ngIf: comment.id --><h3 ng-if="comment.id" class="ng-binding ng-scope">Comment #2</h3><!-- end ngIf: comment.id -->
                <!-- ms to seconds. -->
                <small class="ng-binding">
                  Posted on Nov 25, 2012 by
                  <i class="ng-binding">Quick Horse</i>
                </small>
              </div>

              <!-- TODO(chrsmith): Get the formatting right. Google Code comments
              are not stored in wiki/markdown or HTML format. So we probably need to
              create a custom filter to get 100% paritiy. -->
              <!-- ngIf: comment.content --><span ng-if="comment.content" class="ng-scope">
                <markdown-widget text="comment.content" class="markdown"><p>Running the latest trunk.  Yes, opus is enabled and working on the server.  I tested it with jitsi.  I'm aware of the config bug that was present in freeswitch previously.  This is specific to csip.</p></markdown-widget>
              </span><!-- end ngIf: comment.content -->
              <!-- ngIf: !comment.content -->

              <!-- ngIf: comment.attachments.length -->
              <!-- ngRepeat: attachment in comment.attachments -->
            </div><!-- end ngRepeat: comment in issueCtrl.issue.comments --><div ng-repeat="comment in issueCtrl.issue.comments" class="ng-scope">
              <div>
                <!-- ngIf: comment.id --><h3 ng-if="comment.id" class="ng-binding ng-scope">Comment #3</h3><!-- end ngIf: comment.id -->
                <!-- ms to seconds. -->
                <small class="ng-binding">
                  Posted on Nov 25, 2012 by
                  <i class="ng-binding">Quick Hippo</i>
                </small>
              </div>

              <!-- TODO(chrsmith): Get the formatting right. Google Code comments
              are not stored in wiki/markdown or HTML format. So we probably need to
              create a custom filter to get 100% paritiy. -->
              <!-- ngIf: comment.content --><span ng-if="comment.content" class="ng-scope">
                <markdown-widget text="comment.content" class="markdown"><p>It was not something with the config
See :
<a href="https://groups.google.com/d/msg/csipsimple-users/RI1Cwriy2W8/65pP89whKlcJ">https://groups.google.com/d/msg/csipsimple-users/RI1Cwriy2W8/65pP89whKlcJ</a></p>

<p>It was something with timestamps and frame size.
Some SIP implementations that are not aware of timestamps or doesn't manage it the same way in jitter buffer may not be impacted by this problem.</p>

<p>What could be interesting is some tcpdump traces from the server. Could help to check rtp packets sent by the server.</p>

<p>I did some tests with opus on a fixed FS server and seems it worked fine in encoding and decoding. BTW, if you are affected by this problem it should be only for decoding and you should have clear outgoing voice, is it the case?</p></markdown-widget>
              </span><!-- end ngIf: comment.content -->
              <!-- ngIf: !comment.content -->

              <!-- ngIf: comment.attachments.length -->
              <!-- ngRepeat: attachment in comment.attachments -->
            </div><!-- end ngRepeat: comment in issueCtrl.issue.comments --><div ng-repeat="comment in issueCtrl.issue.comments" class="ng-scope">
              <div>
                <!-- ngIf: comment.id --><h3 ng-if="comment.id" class="ng-binding ng-scope">Comment #4</h3><!-- end ngIf: comment.id -->
                <!-- ms to seconds. -->
                <small class="ng-binding">
                  Posted on Nov 25, 2012 by
                  <i class="ng-binding">Quick Horse</i>
                </small>
              </div>

              <!-- TODO(chrsmith): Get the formatting right. Google Code comments
              are not stored in wiki/markdown or HTML format. So we probably need to
              create a custom filter to get 100% paritiy. -->
              <!-- ngIf: comment.content --><span ng-if="comment.content" class="ng-scope">
                <markdown-widget text="comment.content" class="markdown"><p>Yeah, I kept up with that google groups posting.  Made sure I updated to the latest freeswitch before I started thinking it was csip.  Here's a recording from csip of me calling voicemail using opus <a href="https://kincke.com/wp-content/uploads/2012/11/sip__97@kincke_com__12-11-25_131745.wav">https://kincke.com/wp-content/uploads/2012/11/sip__97@kincke_com__12-11-25_131745.wav</a></p>

<p>And calling another person while I am using opus and they are using silk causes similar results.  They hear me like I'm talking through a fan.</p>

<p>I grabbed a tcpdump, but I'm not sure if it contains any passwords in it (new at reading pcap files).</p></markdown-widget>
              </span><!-- end ngIf: comment.content -->
              <!-- ngIf: !comment.content -->

              <!-- ngIf: comment.attachments.length -->
              <!-- ngRepeat: attachment in comment.attachments -->
            </div><!-- end ngRepeat: comment in issueCtrl.issue.comments --><div ng-repeat="comment in issueCtrl.issue.comments" class="ng-scope">
              <div>
                <!-- ngIf: comment.id --><h3 ng-if="comment.id" class="ng-binding ng-scope">Comment #5</h3><!-- end ngIf: comment.id -->
                <!-- ms to seconds. -->
                <small class="ng-binding">
                  Posted on Dec 4, 2012 by
                  <i class="ng-binding">Quick Horse</i>
                </small>
              </div>

              <!-- TODO(chrsmith): Get the formatting right. Google Code comments
              are not stored in wiki/markdown or HTML format. So we probably need to
              create a custom filter to get 100% paritiy. -->
              <!-- ngIf: comment.content --><span ng-if="comment.content" class="ng-scope">
                <markdown-widget text="comment.content" class="markdown"><p>Also tested an opus call with antisip for android, which was successful.  So it's definately a csip issue.</p></markdown-widget>
              </span><!-- end ngIf: comment.content -->
              <!-- ngIf: !comment.content -->

              <!-- ngIf: comment.attachments.length -->
              <!-- ngRepeat: attachment in comment.attachments -->
            </div><!-- end ngRepeat: comment in issueCtrl.issue.comments --><div ng-repeat="comment in issueCtrl.issue.comments" class="ng-scope">
              <div>
                <!-- ngIf: comment.id --><h3 ng-if="comment.id" class="ng-binding ng-scope">Comment #6</h3><!-- end ngIf: comment.id -->
                <!-- ms to seconds. -->
                <small class="ng-binding">
                  Posted on Mar 20, 2013 by
                  <i class="ng-binding">Quick Panda</i>
                </small>
              </div>

              <!-- TODO(chrsmith): Get the formatting right. Google Code comments
              are not stored in wiki/markdown or HTML format. So we probably need to
              create a custom filter to get 100% paritiy. -->
              <!-- ngIf: comment.content --><span ng-if="comment.content" class="ng-scope">
                <markdown-widget text="comment.content" class="markdown"><p>Can confirm the broken audio issue with the current Play version of CSipSimple and a very recent (March) Freeswitch build using the codec line opus@20i in Freeswitch.</p>

<p>However, I can also confirm that this is fixed in the latest CSipSimple nightly build.</p></markdown-widget>
              </span><!-- end ngIf: comment.content -->
              <!-- ngIf: !comment.content -->

              <!-- ngIf: comment.attachments.length -->
              <!-- ngRepeat: attachment in comment.attachments -->
            </div><!-- end ngRepeat: comment in issueCtrl.issue.comments -->
          </div>

          <!-- Sidebar with additional information -->
          <div class="maia-col-4">
            <div class="maia-aside">
              <p>Status: <code class="ng-binding">Need-Details</code></p>
              <!-- ngIf: issueCtrl.issue.labels.length > 0 --><p ng-if="issueCtrl.issue.labels.length &gt; 0" class="ng-scope">
                Labels:
                <br>
                <!-- ngRepeat: label in issueCtrl.issue.labels track by $index --><span ng-repeat="label in issueCtrl.issue.labels track by $index" class="ng-scope">
                  <span class="gca-label ng-binding">Type-Defect</span>
                </span><!-- end ngRepeat: label in issueCtrl.issue.labels track by $index --><span ng-repeat="label in issueCtrl.issue.labels track by $index" class="ng-scope">
                  <span class="gca-label ng-binding">Priority-Medium</span>
                </span><!-- end ngRepeat: label in issueCtrl.issue.labels track by $index -->
              </p><!-- end ngIf: issueCtrl.issue.labels.length > 0 -->
            </div>
          </div>
        </div><!-- end ngIf: !issueCtrl.error -->
      </div>
    </div>

  </div>
</div>
</div></div></div>
    <noscript>
      &lt;p&gt;The Google Code Archive requires JavaScript to be enabled in your browser.&lt;/p&gt;
    </noscript>

    <div id="maia-signature"></div>
    <div class="maia-footer" id="maia-footer">
      <div id="maia-footer-local">
      </div>
      <div id="maia-footer-global">
        <div class="maia-aux">
          <ul>
            <li>
              <a href="//www.google.com/">Google</a>
            </li>
            <li>
              <a href="//www.google.com/intl/en/about/">About Google</a>
            </li>
            <li>
              <a href="//www.google.com/intl/en/policies/privacy/">Privacy</a>
            </li>
            <li>
              <a href="//www.google.com/intl/en/policies/terms/">Terms</a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <script src="//www.google.com/js/maia.js"></script>
  


</body></html>