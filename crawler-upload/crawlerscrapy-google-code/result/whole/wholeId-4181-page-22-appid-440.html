https://code.google.com/archive/p/csipsimple/issues/613<!DOCTYPE html><html class="google ng-scope" lang="en" ng-app="codesiteArchive.application"><head>
    <meta charset="utf-8">
    <meta content="initial-scale=1, minimum-scale=1, width=device-width" name="viewport">

    <!-- https://developers.google.com/webmasters/ajax-crawling/docs/specification -->
    <meta name="fragment" content="!">
    <title>Google Code Archive - Long-term storage for Google Code Project Hosting.</title>

    <link rel="icon" type="image/vnd.microsoft.icon" href="/archive/img/project-hosting.ico">
    <script src="//www.google.com/js/google.js"></script>
    <link href="//www.google.com/css/maia.css" rel="stylesheet">
    <link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,600,700&amp;lang=en" rel="stylesheet">
    <link rel="stylesheet" href="/archive/archive_css.css">
    <script>
      CLOSURE_NO_DEPS = true;
    </script>
    <script src="/archive/angular.js"></script><style type="text/css">@charset "UTF-8";

[ng\:cloak], [ng-cloak], [data-ng-cloak], [x-ng-cloak],
.ng-cloak, .x-ng-cloak,
.ng-hide:not(.ng-hide-animate) {
  display: none !important;
}

ng\:form {
  display: block;
}

.ng-animate-shim {
  visibility:hidden;
}

.ng-anchor {
  position:absolute;
}
</style>
    <script src="/archive/pagedown.js"></script>
    <script src="/archive/archive.js"></script>
    <base href="/archive/">
  </head>

  <body>
    <div class="maia-header" id="maia-header" role="banner">
      <div class="maia-aux">
        <a href="/archive/">
          </a><h1><a href="/archive/">
            <img alt="Google" src="//www.google.com/images/branding/googlelogo/1x/googlelogo_color_116x41dp.png"> Code</a>
          </h1>
        
        <a href="/archive/">
          <h2>Archive</h2>
        </a>
        <a class="maia-teleport" href="#content">Skip to content</a>
        <div class="maia-util">
          <form action="/archive/search" class="maia-search ng-pristine ng-valid">
            <input name="q" placeholder="Search this site" type="text">
            <button class="maia-button">
              <span class="maia-search-icon">Search</span>
            </button>
          </form>
        </div>
      </div>
    </div>

    <!-- ngView: --><div ng-view="" class="ng-scope"><div ng-controller="ProjectIssueCtrl as issueCtrl" class="ng-scope">
<nav-bar-widget nav-level-1="projectCtrl.navLevel1" class="ng-isolate-scope"><div class="maia-nav maia-complex" id="maia-nav-x" role="navigation">
  <div class="maia-aux">
    <ul>
      <li ng-class="{active: navLevel1 == 'projects'}">
        <a href="/archive/">Projects</a>
        <!-- ngIf: navLevel2 -->
      </li>
      <li ng-class="{active: navLevel1 == 'search'}">
        <a href="/archive/search">Search</a>
      </li>
      <li ng-class="{active: navLevel1 == 'about'}">
        <a href="/archive/about">About</a>
      </li>
    </ul>
  </div>
</div>
</nav-bar-widget>
<div id="maia-main" role="main">

  <!-- ngIf: issueCtrl.notFound -->

  <div ng-hide="issueCtrl.notFound">
    <!-- Left-side resource nav -->
    <project-resources-widget domain="issueCtrl.domain" project="issueCtrl.projectName" class="ng-isolate-scope"><div class="maia-nav" id="maia-nav-y" role="navigation">
  <!-- ngIf: domain == 'code.google.com' --><ul ng-if="domain == 'code.google.com'" class="ng-scope">
    <li class="active">
      <a href="/archive/p/csipsimple/">Project</a>
    </li>
    <li>
      <a href="/archive/p/csipsimple/source">Source</a>
    </li>
    <li>
      <a href="/archive/p/csipsimple/issues">Issues</a>
    </li>
    <li>
      <a href="/archive/p/csipsimple/wikis">Wikis</a>
    </li>
    <li>
      <a href="/archive/p/csipsimple/downloads">Downloads</a>
    </li>
  </ul><!-- end ngIf: domain == 'code.google.com' -->

    <!-- ngIf: domain != 'code.google.com' -->
</div></project-resources-widget>

    <div class="maia-article" role="article">
      <div class="maia-teleport" id="content"></div>
      <div class="maia-cols">
        <div id="gca-project-header" class="maia-col-10">
          <a id="gca-export-to-gh" class="maia-button" href="https://code.google.com/export-to-github/export?project=csipsimple">Export to GitHub</a>
            <img class="gca-project-logo" src="https://storage.googleapis.com/google-code-archive/v2/code.google.com/csipsimple/logo.png">
            <h1 class="ng-binding">csipsimple - issue #613</h1>
            <p class="ng-binding">End call button does not work with a tcp connection</p>
        </div>

        <div class="maia-col-10">
          <hr>

        <!-- ngIf: issueCtrl.error -->

        <!-- ngIf: !issueCtrl.error --><div ng-if="!issueCtrl.error" class="ng-scope">
          <!-- Comments -->
          <div class="maia-col-8">
            <!-- ngRepeat: comment in issueCtrl.issue.comments --><div ng-repeat="comment in issueCtrl.issue.comments" class="ng-scope">
              <div>
                <!-- ngIf: comment.id -->
                <!-- ms to seconds. -->
                <small class="ng-binding">
                  Posted on Jan 22, 2011 by
                  <i class="ng-binding">Swift Bird</i>
                </small>
              </div>

              <!-- TODO(chrsmith): Get the formatting right. Google Code comments
              are not stored in wiki/markdown or HTML format. So we probably need to
              create a custom filter to get 100% paritiy. -->
              <!-- ngIf: comment.content --><span ng-if="comment.content" class="ng-scope">
                <markdown-widget text="comment.content" class="markdown"><p><b>What steps will reproduce the problem?</b>
1. place or receive calls via pbxes.org (transport=tcp)
2. press "end call" button
<b>3.</b></p>

<p><b>What is the expected output? What do you see instead?</b>
expected to end the call
nothing is happening - it seems to end the call after some timeout (sometimes more than 40 seconds later)</p>

<p><b>What version of the product are you using? On what operating system?</b>
0.00-16 on Froyo (2.2) on a HTC Desire</p>

<p><b>Please provide any additional information below.</b>
I forced the use of tcp-transport with two settings (configured with the expert-wizard):
* registrar URL: sip:pbxes.org;transport=tcp
* protocol settings: force TCP</p>

<p>in the network dump i can see UDP packets transmitting the BYE-Request to pbxes, which it seems to ignore because of tcp-transport chosen</p>

<p>some lines of the log file:
D/libpjsip( 2628):  12:54:13.330   pjsua_core.c  TX 329 bytes Response msg 200/NOTIFY/cseq=102 (tdta0x64e470) to tcp 188.40.65.170:5060:
D/libpjsip( 2628):  12:54:36.936   pjsua_core.c  TX 323 bytes Response msg 100/INVITE/cseq=102 (tdta0x2663b8) to tcp 188.40.65.170:5060:
D/libpjsip( 2628):  12:54:37.054   pjsua_core.c  TX 519 bytes Response msg 180/INVITE/cseq=102 (tdta0x2663b8) to tcp 188.40.65.170:5060:
D/libpjsip( 2628):  12:54:37.233   pjsua_core.c  TX 519 bytes Response msg 180/INVITE/cseq=102 (tdta0x2663b8) to tcp 188.40.65.170:5060:
D/libpjsip( 2628):  12:54:39.292   pjsua_core.c  TX 876 bytes Response msg 200/INVITE/cseq=102 (tdta0x2663b8) to tcp 188.40.65.170:5060:
D/libpjsip( 2628):  12:54:42.259   pjsua_core.c  TX 429 bytes Request msg BYE/cseq=27831 (tdta0x646d60) to UDP 188.40.65.170:5060:
D/libpjsip( 2628):  12:54:42.762   pjsua_core.c  TX 429 bytes Request msg BYE/cseq=27831 (tdta0x646d60) to UDP 188.40.65.170:5060:
D/libpjsip( 2628):  12:54:43.761   pjsua_core.c  TX 429 bytes Request msg BYE/cseq=27831 (tdta0x646d60) to UDP 188.40.65.170:5060:
D/libpjsip( 2628):  12:54:45.762   pjsua_core.c  TX 429 bytes Request msg BYE/cseq=27831 (tdta0x646d60) to UDP 188.40.65.170:5060:
D/libpjsip( 2628):  12:54:47.862   pjsua_core.c  TX 429 bytes Request msg BYE/cseq=27832 (tdta0x3a2eb8) to UDP 188.40.65.170:5060:
D/libpjsip( 2628):  12:54:48.362   pjsua_core.c  TX 429 bytes Request msg BYE/cseq=27832 (tdta0x3a2eb8) to UDP 188.40.65.170:5060:</p></markdown-widget>
              </span><!-- end ngIf: comment.content -->
              <!-- ngIf: !comment.content -->

              <!-- ngIf: comment.attachments.length -->
              <!-- ngRepeat: attachment in comment.attachments -->
            </div><!-- end ngRepeat: comment in issueCtrl.issue.comments --><div ng-repeat="comment in issueCtrl.issue.comments" class="ng-scope">
              <div>
                <!-- ngIf: comment.id --><h3 ng-if="comment.id" class="ng-binding ng-scope">Comment #1</h3><!-- end ngIf: comment.id -->
                <!-- ms to seconds. -->
                <small class="ng-binding">
                  Posted on Jan 22, 2011 by
                  <i class="ng-binding">Quick Hippo</i>
                </small>
              </div>

              <!-- TODO(chrsmith): Get the formatting right. Google Code comments
              are not stored in wiki/markdown or HTML format. So we probably need to
              create a custom filter to get 100% paritiy. -->
              <!-- ngIf: comment.content --><span ng-if="comment.content" class="ng-scope">
                <markdown-widget text="comment.content" class="markdown"><p>It has already been debated on this issue list.
That's cause of the fact pbxes.org does not support TCP according to SIP RFC !!!</p>

<p>They reply with a non valid route (removing TCP transport from the route) so that pjsip acts just following what is defined in the RFC and reply using UDP cause pbxes.org server actually ask for that !! 
So cry to pbxes.org for that. The only thing I can do is a workaround. But I consider it's up to the SIP server to follow SIP RFC. 
I know what will be the answer of pbxes.org however..; they'll say to you to use sipdroid cause that's the client they develop.... but they do not implement SIP over TCP following RFC ... just their own SIP protocol...</p>

<p>As consequence in pbxes.org wizard I've removed the TCP option. Which is still there for other SIP providers that actually support TCP (for example ippi).</p></markdown-widget>
              </span><!-- end ngIf: comment.content -->
              <!-- ngIf: !comment.content -->

              <!-- ngIf: comment.attachments.length -->
              <!-- ngRepeat: attachment in comment.attachments -->
            </div><!-- end ngRepeat: comment in issueCtrl.issue.comments -->
          </div>

          <!-- Sidebar with additional information -->
          <div class="maia-col-4">
            <div class="maia-aside">
              <p>Status: <code class="ng-binding">Duplicate</code></p>
              <!-- ngIf: issueCtrl.issue.labels.length > 0 --><p ng-if="issueCtrl.issue.labels.length &gt; 0" class="ng-scope">
                Labels:
                <br>
                <!-- ngRepeat: label in issueCtrl.issue.labels track by $index --><span ng-repeat="label in issueCtrl.issue.labels track by $index" class="ng-scope">
                  <span class="gca-label ng-binding">Type-Defect</span>
                </span><!-- end ngRepeat: label in issueCtrl.issue.labels track by $index --><span ng-repeat="label in issueCtrl.issue.labels track by $index" class="ng-scope">
                  <span class="gca-label ng-binding">Priority-Medium</span>
                </span><!-- end ngRepeat: label in issueCtrl.issue.labels track by $index -->
              </p><!-- end ngIf: issueCtrl.issue.labels.length > 0 -->
            </div>
          </div>
        </div><!-- end ngIf: !issueCtrl.error -->
      </div>
    </div>

  </div>
</div>
</div></div></div>
    <noscript>
      &lt;p&gt;The Google Code Archive requires JavaScript to be enabled in your browser.&lt;/p&gt;
    </noscript>

    <div id="maia-signature"></div>
    <div class="maia-footer" id="maia-footer">
      <div id="maia-footer-local">
      </div>
      <div id="maia-footer-global">
        <div class="maia-aux">
          <ul>
            <li>
              <a href="//www.google.com/">Google</a>
            </li>
            <li>
              <a href="//www.google.com/intl/en/about/">About Google</a>
            </li>
            <li>
              <a href="//www.google.com/intl/en/policies/privacy/">Privacy</a>
            </li>
            <li>
              <a href="//www.google.com/intl/en/policies/terms/">Terms</a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <script src="//www.google.com/js/maia.js"></script>
  


</body></html>