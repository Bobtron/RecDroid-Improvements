https://code.google.com/archive/p/csipsimple/issues/1626<!DOCTYPE html><html class="google ng-scope" lang="en" ng-app="codesiteArchive.application"><head>
    <meta charset="utf-8">
    <meta content="initial-scale=1, minimum-scale=1, width=device-width" name="viewport">

    <!-- https://developers.google.com/webmasters/ajax-crawling/docs/specification -->
    <meta name="fragment" content="!">
    <title>Google Code Archive - Long-term storage for Google Code Project Hosting.</title>

    <link rel="icon" type="image/vnd.microsoft.icon" href="/archive/img/project-hosting.ico">
    <script src="//www.google.com/js/google.js"></script>
    <link href="//www.google.com/css/maia.css" rel="stylesheet">
    <link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,600,700&amp;lang=en" rel="stylesheet">
    <link rel="stylesheet" href="/archive/archive_css.css">
    <script>
      CLOSURE_NO_DEPS = true;
    </script>
    <script src="/archive/angular.js"></script><style type="text/css">@charset "UTF-8";

[ng\:cloak], [ng-cloak], [data-ng-cloak], [x-ng-cloak],
.ng-cloak, .x-ng-cloak,
.ng-hide:not(.ng-hide-animate) {
  display: none !important;
}

ng\:form {
  display: block;
}

.ng-animate-shim {
  visibility:hidden;
}

.ng-anchor {
  position:absolute;
}
</style>
    <script src="/archive/pagedown.js"></script>
    <script src="/archive/archive.js"></script>
    <base href="/archive/">
  </head>

  <body>
    <div class="maia-header" id="maia-header" role="banner">
      <div class="maia-aux">
        <a href="/archive/">
          </a><h1><a href="/archive/">
            <img alt="Google" src="//www.google.com/images/branding/googlelogo/1x/googlelogo_color_116x41dp.png"> Code</a>
          </h1>
        
        <a href="/archive/">
          <h2>Archive</h2>
        </a>
        <a class="maia-teleport" href="#content">Skip to content</a>
        <div class="maia-util">
          <form action="/archive/search" class="maia-search ng-pristine ng-valid">
            <input name="q" placeholder="Search this site" type="text">
            <button class="maia-button">
              <span class="maia-search-icon">Search</span>
            </button>
          </form>
        </div>
      </div>
    </div>

    <!-- ngView: --><div ng-view="" class="ng-scope"><div ng-controller="ProjectIssueCtrl as issueCtrl" class="ng-scope">
<nav-bar-widget nav-level-1="projectCtrl.navLevel1" class="ng-isolate-scope"><div class="maia-nav maia-complex" id="maia-nav-x" role="navigation">
  <div class="maia-aux">
    <ul>
      <li ng-class="{active: navLevel1 == 'projects'}">
        <a href="/archive/">Projects</a>
        <!-- ngIf: navLevel2 -->
      </li>
      <li ng-class="{active: navLevel1 == 'search'}">
        <a href="/archive/search">Search</a>
      </li>
      <li ng-class="{active: navLevel1 == 'about'}">
        <a href="/archive/about">About</a>
      </li>
    </ul>
  </div>
</div>
</nav-bar-widget>
<div id="maia-main" role="main">

  <!-- ngIf: issueCtrl.notFound -->

  <div ng-hide="issueCtrl.notFound">
    <!-- Left-side resource nav -->
    <project-resources-widget domain="issueCtrl.domain" project="issueCtrl.projectName" class="ng-isolate-scope"><div class="maia-nav" id="maia-nav-y" role="navigation">
  <!-- ngIf: domain == 'code.google.com' --><ul ng-if="domain == 'code.google.com'" class="ng-scope">
    <li class="active">
      <a href="/archive/p/csipsimple/">Project</a>
    </li>
    <li>
      <a href="/archive/p/csipsimple/source">Source</a>
    </li>
    <li>
      <a href="/archive/p/csipsimple/issues">Issues</a>
    </li>
    <li>
      <a href="/archive/p/csipsimple/wikis">Wikis</a>
    </li>
    <li>
      <a href="/archive/p/csipsimple/downloads">Downloads</a>
    </li>
  </ul><!-- end ngIf: domain == 'code.google.com' -->

    <!-- ngIf: domain != 'code.google.com' -->
</div></project-resources-widget>

    <div class="maia-article" role="article">
      <div class="maia-teleport" id="content"></div>
      <div class="maia-cols">
        <div id="gca-project-header" class="maia-col-10">
          <a id="gca-export-to-gh" class="maia-button" href="https://code.google.com/export-to-github/export?project=csipsimple">Export to GitHub</a>
            <img class="gca-project-logo" src="https://storage.googleapis.com/google-code-archive/v2/code.google.com/csipsimple/logo.png">
            <h1 class="ng-binding">csipsimple - issue #1626</h1>
            <p class="ng-binding">Flowroute wizard</p>
        </div>

        <div class="maia-col-10">
          <hr>

        <!-- ngIf: issueCtrl.error -->

        <!-- ngIf: !issueCtrl.error --><div ng-if="!issueCtrl.error" class="ng-scope">
          <!-- Comments -->
          <div class="maia-col-8">
            <!-- ngRepeat: comment in issueCtrl.issue.comments --><div ng-repeat="comment in issueCtrl.issue.comments" class="ng-scope">
              <div>
                <!-- ngIf: comment.id -->
                <!-- ms to seconds. -->
                <small class="ng-binding">
                  Posted on Mar 12, 2012 by
                  <i class="ng-binding">Quick Hippo</i>
                </small>
              </div>

              <!-- TODO(chrsmith): Get the formatting right. Google Code comments
              are not stored in wiki/markdown or HTML format. So we probably need to
              create a custom filter to get 100% paritiy. -->
              <!-- ngIf: comment.content --><span ng-if="comment.content" class="ng-scope">
                <markdown-widget text="comment.content" class="markdown"><p>Hello,</p>

<p>Whenever I make a call on flowroute, the caller ID shows up as my flowroute account number instead of caller ID. I contacted flowroute support about it and they sent me the following:</p>

<p>Mo Merchant, Feb 25 12:13 pm (PST):
Hello,</p>

<p>Thank you for your support inquiry. Does the cSIPSimple application offer a field for 'Auth ID' or 'Caller ID'? From what you have pasted, it appears that the application is transmitting caller ID in the From field and in doing so transmitting your SIP Username instead of your Google Voice.</p>

<p>To correct this, please request the developers of cSIPSimple to either:</p>

<p>Option 1 -- Add an authorization ID field such that you can populate that field with your SIP Username and use the username field in the From field to transmit caller ID.</p>

<p>Option 2 -- Have the caller ID field within the application (should there be one) map to the SIP header field of either Remote Party ID or P-Asserted Identity. This method would be a better solution for greater reliability and application 'robustness'.</p>

<p>Please let me know if you have any additional questions.</p>

<p>Regards,</p>

<p>Mo Merchant
Flowroute Support</p>

<p>This seems like an incredibly helpful response! Is it possible that one of these options could be implemented?</p></markdown-widget>
              </span><!-- end ngIf: comment.content -->
              <!-- ngIf: !comment.content -->

              <!-- ngIf: comment.attachments.length -->
              <!-- ngRepeat: attachment in comment.attachments -->
            </div><!-- end ngRepeat: comment in issueCtrl.issue.comments --><div ng-repeat="comment in issueCtrl.issue.comments" class="ng-scope">
              <div>
                <!-- ngIf: comment.id --><h3 ng-if="comment.id" class="ng-binding ng-scope">Comment #1</h3><!-- end ngIf: comment.id -->
                <!-- ms to seconds. -->
                <small class="ng-binding">
                  Posted on Mar 13, 2012 by
                  <i class="ng-binding">Helpful Kangaroo</i>
                </small>
              </div>

              <!-- TODO(chrsmith): Get the formatting right. Google Code comments
              are not stored in wiki/markdown or HTML format. So we probably need to
              create a custom filter to get 100% paritiy. -->
              <!-- ngIf: comment.content --><span ng-if="comment.content" class="ng-scope">
                <markdown-widget text="comment.content" class="markdown"><p>you have this option:</p>

<p>Settings - Call options - Caller ID 
enter your phone number...</p></markdown-widget>
              </span><!-- end ngIf: comment.content -->
              <!-- ngIf: !comment.content -->

              <!-- ngIf: comment.attachments.length -->
              <!-- ngRepeat: attachment in comment.attachments -->
            </div><!-- end ngRepeat: comment in issueCtrl.issue.comments --><div ng-repeat="comment in issueCtrl.issue.comments" class="ng-scope">
              <div>
                <!-- ngIf: comment.id --><h3 ng-if="comment.id" class="ng-binding ng-scope">Comment #2</h3><!-- end ngIf: comment.id -->
                <!-- ms to seconds. -->
                <small class="ng-binding">
                  Posted on Mar 13, 2012 by
                  <i class="ng-binding">Quick Hippo</i>
                </small>
              </div>

              <!-- TODO(chrsmith): Get the formatting right. Google Code comments
              are not stored in wiki/markdown or HTML format. So we probably need to
              create a custom filter to get 100% paritiy. -->
              <!-- ngIf: comment.content --><span ng-if="comment.content" class="ng-scope">
                <markdown-widget text="comment.content" class="markdown"><p>About authorization field vs username.
The option already exists. Use the "Expert wizard" mode. I can also create a wizard for Flowroute so that this is easy for you to setup.
To do so I'll need basic infos (sip server etc) (see AddASipProvider wiki page).</p>

<p>So this point is already supported by the app without any problem and it's used by many sip wizards. It's just not available in basic wizard because it's not a basic settings and often users gets confused with username and authentication name. That's why I use to do explicit wizards with the labels used by the sip provider so that it takes users 1 minute to configure . 
Well, the first user often needs more time to configure with expert mode, but all other users will benefit it ;) (and often it's done by the sip provider that knows exactly about sip and can gives me best settings for their service).</p>

<p>About the caller ID field. They are absolutely right. P-Asserted Identity is planned to be supported and for now it uses the username as defined in the basic SIP rfc.</p>

<p>P-Asserted Identity, isn't something that is present in <em>basic</em> sip RFC (the standardization of sip protocol). It comes later in IMS protocol. So when they say "robustness" that's not really true, because it deeply depends on the sip server on the other side (or the remote sip client if calling peer to peer). That's why it should remains an option in csipsimple and be considered as a new field in Expert wizard mode. 
Then, if it's known to be supported by Flowroute, I'll add a "Caller ID" field in Flowroute wizard that bind the "P-Asserted-Identity" header. </p>

<p>That's another good reason to add the Flowroute wizard.</p>

<p>So the first step is to provide me infos I need to create the Flowroute wizard. If you don't feel to try to configure with expert mode, maybe you can tell Flowroute to contact me directly, I'll be pleased to add their wizard :). Else we can do a first version with infos you get from configuration you do with other sip client, or any documentation they provide to configure a sip client.</p></markdown-widget>
              </span><!-- end ngIf: comment.content -->
              <!-- ngIf: !comment.content -->

              <!-- ngIf: comment.attachments.length -->
              <!-- ngRepeat: attachment in comment.attachments -->
            </div><!-- end ngRepeat: comment in issueCtrl.issue.comments --><div ng-repeat="comment in issueCtrl.issue.comments" class="ng-scope">
              <div>
                <!-- ngIf: comment.id --><h3 ng-if="comment.id" class="ng-binding ng-scope">Comment #3</h3><!-- end ngIf: comment.id -->
                <!-- ms to seconds. -->
                <small class="ng-binding">
                  Posted on Mar 15, 2012 by
                  <i class="ng-binding">Quick Hippo</i>
                </small>
              </div>

              <!-- TODO(chrsmith): Get the formatting right. Google Code comments
              are not stored in wiki/markdown or HTML format. So we probably need to
              create a custom filter to get 100% paritiy. -->
              <!-- ngIf: comment.content --><span ng-if="comment.content" class="ng-scope">
                <markdown-widget text="comment.content" class="markdown"><p>I've been using Expert mode this whole time, and my account ID is as follows:</p>

<p>3335551212 </p>

<p>Where 3335551212 is the number I'm trying to send for caller ID and 12345678 is my account number. However, the account number is what is being sent as the caller ID.</p>

<p>As for setting up a flowroute wizard, you can make an account for free at flowroute.com with 25c of credit that can be used to test. If that's not sufficient though I can maybe ask their support if they have something for softphone developers :)</p></markdown-widget>
              </span><!-- end ngIf: comment.content -->
              <!-- ngIf: !comment.content -->

              <!-- ngIf: comment.attachments.length -->
              <!-- ngRepeat: attachment in comment.attachments -->
            </div><!-- end ngRepeat: comment in issueCtrl.issue.comments --><div ng-repeat="comment in issueCtrl.issue.comments" class="ng-scope">
              <div>
                <!-- ngIf: comment.id --><h3 ng-if="comment.id" class="ng-binding ng-scope">Comment #4</h3><!-- end ngIf: comment.id -->
                <!-- ms to seconds. -->
                <small class="ng-binding">
                  Posted on Mar 25, 2012 by
                  <i class="ng-binding">Quick Hippo</i>
                </small>
              </div>

              <!-- TODO(chrsmith): Get the formatting right. Google Code comments
              are not stored in wiki/markdown or HTML format. So we probably need to
              create a custom filter to get 100% paritiy. -->
              <!-- ngIf: comment.content --><span ng-if="comment.content" class="ng-scope">
                <markdown-widget text="comment.content" class="markdown"><p>Did you try in expert wizard mode to :
set as sip id : 
3335551212 
And as username / login (in authentication part)
12345678
(normally no need to change, it should already be 12345678)</p>

<p>This way is the equivalent of "Option 1" proposed by the Flowroute support.</p>

<p>I have also added the authorization login vs username in "Advanced wizard" in latest nightly builds. So it can be a little bit more easier to configure than with the expert mode ;)</p>

<hr>

<p>You can ignore the following part of my comment if you don't want to care about the Option 2 of flowroute and technical consideration ;).
It's just my own thought to be able to remember what I found on the "Option 2" proposed by Flowroute support.</p>

<p>As far as I understood it's described here :
<a href="http://www.ietf.org/rfc/rfc3325.txt">http://www.ietf.org/rfc/rfc3325.txt</a></p>

<p>Regarding this RFC, the P-Asserted-Identity should not be send by the user-agent, but only by trusted SIP entities (typically intermediaries).
Besides if you look the example of this RFC, the client never send the "P-Asserted-Identity", but it's added by the proxy in the middle that trust the client... and basically they use information they have about the authenticated user. In my comprehension, in this model it's up to the sip server to be robust, not to the sip client... And your sip server should add this P-Asserted-Identity when it talks to another trusted sip server to pass infos about the authenticated user the call comes from. But it's not up to the sip client to send that. (BTW, else it can't really called robustness...)</p>

<p>So I think that what I should add is the "P-Preferred-Identity".
If that's what is expected, the client send it as an advise the sip proxy to use this identity for the P-Asserted-Identity. But final word is the one of sip server and will be passed in P-Asserted-Identity (and the server has some work to do in order to validate P-Preferred-Identity and pass it to P-Asserted-Identity if it's correct for this user). 
So if nothing is done on Flowroute server it will be absolutely useless adding that. And apparently, they currently do nothing because Preferred is optional and if none is entered the server should be able to retrieve one.
So I'm really not sure it will help in this case.</p>

<p>Then, about when to send it, depending on if I read the IMS 33.978 (<a href="http://www.arib.or.jp/english/html/overview/doc/STD-T63v9_20/5_Appendix/Rel6/33/33978-660.pdf">http://www.arib.or.jp/english/html/overview/doc/STD-T63v9_20/5_Appendix/Rel6/33/33978-660.pdf</a>) or the RFC 3225 (one is for IMS, the other for SIP), the Preferred-Identity should either be sent on REGISTER or on INVITE.</p>

<p>IMS specs advise to send it only in REGISTER while RFC 3225 only allows to send it on INVITE, OPTION, BYE, SUBSCRIBE, NOTIFICATION, REFER (and says it's not applicable in register). 
Since pjsip (the sip stack behind csipsimple) is not yet fully IMS compatible, I would start on the second choice (using pure IETF SIP rfc).</p>

<p>Well... So I'm not sure that's such a robust thing... because depending on the server on the other side (IMS or pure SIP), behaviour should be totally different :S. </p>

<p>Then about Remote-Party-ID : it is defined within an expired draft which never became an RFC... (for reference the corresponding draft : <a href="http://tools.ietf.org/html/draft-ietf-sip-privacy-00">http://tools.ietf.org/html/draft-ietf-sip-privacy-00</a>).
So it's not something eligible to be added to CSipSimple that aim to not introduce proprietary things and just respect standards. 
If each sip client starts adding non standard things none sip clients will be able to talk with each other. It's apparently only used by some cisco equipment (apparently they originated this draft), but since it's not a standard, it's not reliable header. P-Preferred-Identity seems to be the correct one for privacy purpose.
As side note, apparently, the reason why these new parameters was introduced is absolutely not about how to display the username. This can still be done using the AoR display name part (and that's what is currently used by csipsimple as what is abusively named 'caller id' for mainstream users).
The reason is that some sip providers/sip clients wanted to be able to hide / change the user identity in a sip call and so pass anonymous as from and let proxy decide if user identity should or not be passed.</p>

<p>Another addition, some sip server are able to do exactly the same thing without having to need P-Preferred-Identity. Either by simply proxying the request with their own database of corresponding caller id for a user to PSTN network for example, or by using the Display name of the sip id. That's the reason why I call that caller-id because many sip providers do that - a very basic example is all betamax clones.</p>

<h2>Sorry for the long comment ;)</h2></markdown-widget>
              </span><!-- end ngIf: comment.content -->
              <!-- ngIf: !comment.content -->

              <!-- ngIf: comment.attachments.length -->
              <!-- ngRepeat: attachment in comment.attachments -->
            </div><!-- end ngRepeat: comment in issueCtrl.issue.comments --><div ng-repeat="comment in issueCtrl.issue.comments" class="ng-scope">
              <div>
                <!-- ngIf: comment.id --><h3 ng-if="comment.id" class="ng-binding ng-scope">Comment #5</h3><!-- end ngIf: comment.id -->
                <!-- ms to seconds. -->
                <small class="ng-binding">
                  Posted on Mar 25, 2012 by
                  <i class="ng-binding">Quick Hippo</i>
                </small>
              </div>

              <!-- TODO(chrsmith): Get the formatting right. Google Code comments
              are not stored in wiki/markdown or HTML format. So we probably need to
              create a custom filter to get 100% paritiy. -->
              <!-- ngIf: comment.content --><span ng-if="comment.content" class="ng-scope">
                <markdown-widget text="comment.content" class="markdown"><p>This issue was closed by revision r1350.</p></markdown-widget>
              </span><!-- end ngIf: comment.content -->
              <!-- ngIf: !comment.content -->

              <!-- ngIf: comment.attachments.length -->
              <!-- ngRepeat: attachment in comment.attachments -->
            </div><!-- end ngRepeat: comment in issueCtrl.issue.comments --><div ng-repeat="comment in issueCtrl.issue.comments" class="ng-scope">
              <div>
                <!-- ngIf: comment.id --><h3 ng-if="comment.id" class="ng-binding ng-scope">Comment #6</h3><!-- end ngIf: comment.id -->
                <!-- ms to seconds. -->
                <small class="ng-binding">
                  Posted on Mar 25, 2012 by
                  <i class="ng-binding">Quick Hippo</i>
                </small>
              </div>

              <!-- TODO(chrsmith): Get the formatting right. Google Code comments
              are not stored in wiki/markdown or HTML format. So we probably need to
              create a custom filter to get 100% paritiy. -->
              <!-- ngIf: comment.content --><span ng-if="comment.content" class="ng-scope">
                <markdown-widget text="comment.content" class="markdown"><p>That change worked, thank you :)</p></markdown-widget>
              </span><!-- end ngIf: comment.content -->
              <!-- ngIf: !comment.content -->

              <!-- ngIf: comment.attachments.length -->
              <!-- ngRepeat: attachment in comment.attachments -->
            </div><!-- end ngRepeat: comment in issueCtrl.issue.comments --><div ng-repeat="comment in issueCtrl.issue.comments" class="ng-scope">
              <div>
                <!-- ngIf: comment.id --><h3 ng-if="comment.id" class="ng-binding ng-scope">Comment #7</h3><!-- end ngIf: comment.id -->
                <!-- ms to seconds. -->
                <small class="ng-binding">
                  Posted on Mar 26, 2012 by
                  <i class="ng-binding">Quick Hippo</i>
                </small>
              </div>

              <!-- TODO(chrsmith): Get the formatting right. Google Code comments
              are not stored in wiki/markdown or HTML format. So we probably need to
              create a custom filter to get 100% paritiy. -->
              <!-- ngIf: comment.content --><span ng-if="comment.content" class="ng-scope">
                <markdown-widget text="comment.content" class="markdown"><p>Great :)</p>

<p>So the r1350 Flowroute wizard will help ;). It's in "world wide" section of nightly builds : <a href="http://nightlies.csipsimple.com/trunk/">http://nightlies.csipsimple.com/trunk/</a></p>

<p>If you can test it and confirms it works out of box with this wizard and that field names are what is expected by Flowroute, it will be great.</p></markdown-widget>
              </span><!-- end ngIf: comment.content -->
              <!-- ngIf: !comment.content -->

              <!-- ngIf: comment.attachments.length -->
              <!-- ngRepeat: attachment in comment.attachments -->
            </div><!-- end ngRepeat: comment in issueCtrl.issue.comments --><div ng-repeat="comment in issueCtrl.issue.comments" class="ng-scope">
              <div>
                <!-- ngIf: comment.id --><h3 ng-if="comment.id" class="ng-binding ng-scope">Comment #8</h3><!-- end ngIf: comment.id -->
                <!-- ms to seconds. -->
                <small class="ng-binding">
                  Posted on Apr 2, 2012 by
                  <i class="ng-binding">Quick Hippo</i>
                </small>
              </div>

              <!-- TODO(chrsmith): Get the formatting right. Google Code comments
              are not stored in wiki/markdown or HTML format. So we probably need to
              create a custom filter to get 100% paritiy. -->
              <!-- ngIf: comment.content --><span ng-if="comment.content" class="ng-scope">
                <markdown-widget text="comment.content" class="markdown"><p>Just wanted to report that I tried r1364's flowroute wizard and it seems to have worked great :D</p></markdown-widget>
              </span><!-- end ngIf: comment.content -->
              <!-- ngIf: !comment.content -->

              <!-- ngIf: comment.attachments.length -->
              <!-- ngRepeat: attachment in comment.attachments -->
            </div><!-- end ngRepeat: comment in issueCtrl.issue.comments -->
          </div>

          <!-- Sidebar with additional information -->
          <div class="maia-col-4">
            <div class="maia-aside">
              <p>Status: <code class="ng-binding">Fixed</code></p>
              <!-- ngIf: issueCtrl.issue.labels.length > 0 --><p ng-if="issueCtrl.issue.labels.length &gt; 0" class="ng-scope">
                Labels:
                <br>
                <!-- ngRepeat: label in issueCtrl.issue.labels track by $index --><span ng-repeat="label in issueCtrl.issue.labels track by $index" class="ng-scope">
                  <span class="gca-label ng-binding">Type-Defect</span>
                </span><!-- end ngRepeat: label in issueCtrl.issue.labels track by $index --><span ng-repeat="label in issueCtrl.issue.labels track by $index" class="ng-scope">
                  <span class="gca-label ng-binding">Priority-Medium</span>
                </span><!-- end ngRepeat: label in issueCtrl.issue.labels track by $index -->
              </p><!-- end ngIf: issueCtrl.issue.labels.length > 0 -->
            </div>
          </div>
        </div><!-- end ngIf: !issueCtrl.error -->
      </div>
    </div>

  </div>
</div>
</div></div></div>
    <noscript>
      &lt;p&gt;The Google Code Archive requires JavaScript to be enabled in your browser.&lt;/p&gt;
    </noscript>

    <div id="maia-signature"></div>
    <div class="maia-footer" id="maia-footer">
      <div id="maia-footer-local">
      </div>
      <div id="maia-footer-global">
        <div class="maia-aux">
          <ul>
            <li>
              <a href="//www.google.com/">Google</a>
            </li>
            <li>
              <a href="//www.google.com/intl/en/about/">About Google</a>
            </li>
            <li>
              <a href="//www.google.com/intl/en/policies/privacy/">Privacy</a>
            </li>
            <li>
              <a href="//www.google.com/intl/en/policies/terms/">Terms</a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <script src="//www.google.com/js/maia.js"></script>
  


</body></html>